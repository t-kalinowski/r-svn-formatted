<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: R News</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for NEWS"><tr><td>NEWS</td><td align="right">R Documentation</td></tr></table>

<h2>R News</h2>


<h3>CHANGES IN R VERSION 2.12.0</h3>

<p>


<h4>NEW FEATURES</h4>

<p>

<ul>
<li> Reading a packages's <code>CITATION</code> file now defaults to
ASCII rather than Latin-1: a package with a non-ASCII
<code>CITATION</code> file should declare an encoding in their
<code>DESCRIPTION</code> file and use that encoding for the
<code>CITATION</code> file.
</p>
<p>
</li>
<li><code>difftime()</code> now defaults to the <code>"tzone"</code>
attribute of <code>"POSIXlt"</code> objects rather than to the current
timezone as set by the default for the <code>'tz'</code> argument.  (Wish
of <a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14182">PR#14182</a>.)
</p>
<p>
</li>
<li><code>pretty()</code> is now generic, with new methods for
<code>"Date"</code> and <code>"POSIXt"</code> classes (based on code
contributed by Felix Andrews).
</p>
<p>
</li>
<li><code>unique()</code> and <code>match()</code> are now faster on
character vectors where all elements are in the global CHARSXP
cache and have unmarked encoding (ASCII).  Thanks to Matthew
Dowle for suggesting improvements to the way the hash code is
generated in unique.c.
</p>
<p>
</li>
<li>The <code>enquote()</code> utility, in use internally, is exported now.
</p>
<p>
</li>
<li><code>.C()</code> and <code>.Fortran()</code> now map non-zero return
values (other than <code>NA_LOGICAL</code>) for logical vectors to
<code>TRUE</code>: it has been an implicit assumption that they are
treated as true.
</p>
<p>
</li>
<li>The <code>print()</code> methods for <code>"glm"</code> and <code>"lm"</code>
objects now insert linebreaks in long calls in the same way that
the <code>print()</code> methods for <code>"summary.[g]lm"</code> objects
have long done.  This does change the layout of the examples for
a number of packages, e.g. <code>MASS</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14250">PR#14250</a>)
</p>
<p>
</li>
<li><code>constrOptim()</code> can now be used with method
<code>"SANN"</code>.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14245">PR#14245</a>)
</p>
<p>
It gains an argument <code>'hessian'</code> to be passed to
<code>optim()</code>, which allows all the <code>...</code> arguments to be
intended for <code>f()</code> and <code>grad()</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14071">PR#14071</a>)
</p>
<p>
</li>
<li><code>curve()</code> now allows <code>'expr'</code> to be an object of
mode <code>"expression"</code> as well as <code>"call"</code> and
<code>"function"</code>.
</p>
<p>
</li>
<li>The <code>"POSIX[cl]t"</code> methods for <code>Axis()</code> have been
replaced by a single method for <code>"POSIXt"</code>.
</p>
<p>
There are no longer separate <code>plot()</code> methods for
<code>"POSIX[cl]t"</code> and <code>"Date"</code>: the default method has
been able to handle those classes for a long time.  This
<EM>inter alia</EM> allows a single date-time object to be
supplied, the wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14016">PR#14016</a>.
</p>
<p>
The methods had a different default (<code>""</code>) for <code>xlab</code>.
</p>
<p>
</li>
<li>Classes <code>"POSIXct"</code>, <code>"POSIXlt"</code> and
<code>"difftime"</code> have generators <code>.POSIXct()</code>,
<code>.POSIXlt()</code> and <code>.difftime()</code>.  Package authors are
advised to make use of them (they are available from <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.11.0) to
proof against planned future changes to the classes.
</p>
<p>
The ordering of the classes has been changed, so <code>"POSIXt"</code>
is now the second class.  See the document &lsquo;Updating
packages for changes in R 2.12.x&rsquo; on
<a href="http://developer.r-project.org">http://developer.r-project.org</a> for the consequences for a
handful of CRAN packages.
</p>
<p>
</li>
<li>The <code>"POSIXct"</code> method of <code>as.Date()</code> allows a
timezone to be specified (but still defaults to UTC).
</p>
<p>
</li>
<li>New <code>list2env()</code> utility function as an inverse of
<code>as.list(&lt;environment&gt;)</code> and for fast multi-<code>assign()</code>
to existing environment.  <code>as.environment()</code> is now generic
and uses <code>list2env()</code> as list method.
</p>
<p>
</li>
<li>There are several small changes to output which &lsquo;zap&rsquo;
small numbers, e.g. in printing quantiles of residuals in
summaries from <code>"lm"</code> and <code>"glm"</code> fits, and in test
statisics in <code>print.anova()</code>.
</p>
<p>
</li>
<li>Special names such as <code>"dim"</code>, <code>"names"</code>, etc, are
now allowed as slot names of S4 classes, with <code>"class"</code> the
only remaining exception.
</p>
<p>
</li>
<li>&lsquo;<span class="file">.Renviron</span>&rsquo; can have architecture-specific versions
such as &lsquo;<span class="file">.Renviron.i386</span>&rsquo; on systems with sub-architectures.
</p>
<p>
</li>
<li><code>installed.packages()</code> has a new argument
<code>'subarch'</code> to filter on sub-architecture.
</p>
<p>
</li>
<li>The <code>summary()</code> method for <code>packageStatus()</code> now
has a separate <code>print()</code> method.
</p>
<p>
</li>
<li>The default <code>summary()</code> method returns an object
inheriting from class <code>"summaryDefault"</code> which has a
separate <code>print()</code> method that calls <code>zapsmall()</code> for
numeric/complex values.
</p>
<p>
</li>
<li>The startup message now includes the platform and if used,
sub-architecture: this is useful where different
(sub-)architectures run on the same OS.
</p>
<p>
</li>
<li>The <code>getGraphicsEvent()</code> mechanism now allows multiple windows
to return graphics events, through the new functions
<code>setGraphicsEventHandlers()</code>, <code>setGraphicsEventEnv()</code>, and
<code>getGraphicsEventEnv()</code>.  (Currently implemented in the
<code>windows()</code> and <code>X11()</code> devices.)
</p>
<p>
</li>
<li><code>tools::texi2dvi()</code> gains an <code>'index'</code> argument,
mainly for use by <CODE>R CMD Rd2pdf</CODE>.
</p>
<p>
It avoids the use of <CODE>'texindy'</CODE> by <CODE>texinfo</CODE>'s
<CODE>texi2dvi &gt;= 1.157</CODE>, since that does not emulate
'makeindex' well enough to avoid problems with special characters
(such as '(', '{', '!') in indices.
</p>
<p>
</li>
<li>The ability of <code>readLines()</code> and <code>scan()</code> to
re-encode inputs to marked UTF-8 strings on Windows since <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.7.0
is extended to non-UTF-8 locales on other OSes.
</p>
<p>
</li>
<li><code>scan()</code> gains a <code>'fileEncoding'</code> argument to
match <code>read.table()</code>.
</p>
<p>
</li>
<li><code>points()</code> and <code>lines()</code> gain <code>"table"</code>
methods to match <code>plot()</code>.  (Wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=10472">PR#10472</a>.)
</p>
<p>
</li>
<li><code>Sys.chmod()</code> allows <code>'mode'</code> to be a vector,
recycled along <code>'paths'</code>.
</p>
<p>
</li>
<li>There are <code>|</code>, <code>&amp;</code> and <code>xor()</code> methods for
classes <code>"octmode"</code> and <code>"hexmode"</code>, which work
bitwise.
</p>
<p>
</li>
<li>Environment variables <code>R_DVIPSCMD</code>, <code>R_LATEXCMD</code>,
<code>R_MAKEINDEXCMD</code>, <code>R_PDFLATEXCMD</code> are no longer used
nor set in an <font face="Courier New,Courier" color="#666666"><b>R</b></font> session.  (With the move to
<code>tools::texi2dvi()</code>, the conventional environment variables
<code>LATEX</code>, <code>MAKEINDEX</code> and <code>PDFLATEX</code> will be used.
<code>options("dvipscmd")</code> defaults to the value of <code>DVIPS</code>,
then to <code>"dvips"</code>.)
</p>
<p>
</li>
<li>New function <code>isatty()</code> to see if terminal connections are
redirected.
</p>
<p>
</li>
<li><code>summaryRprof()</code> returns the sampling interval in
component <code>'sample.interval'</code> and only returns in
<code>'by.self'</code> data for functions with non-zero self times.
</p>
<p>
</li>
<li><code>print(x)</code> and <code>str(x)</code> now indicate if an empty
list <code>x</code> is named.
</p>
<p>
</li>
<li><code>install.packages()</code> and <code>remove.packages()</code> with
<code>'lib'</code> unspecified and multiple libraries in
<code>.libPaths()</code> inform the user of the library location used
with a message rather than a warning.
</p>
<p>
</li>
<li>There is limited support for multiple compressed streams on a
file: all of <code>[bgx]zfile()</code> allow streams to be appended to an
existing file, but <code>bzfile()</code> reads only the first stream.
</p>
<p>
</li>
<li>Function <code>person()</code> in package <code>'utils'</code> now uses
a given/family scheme in preference to first/middle/last, is
vectorized to handle an arbitrary number of persons, and gains a
<code>'role'</code> argument to specify person roles using a controlled
vocabulary (the MARC relator terms).
</p>
<p>
</li>
<li>Package <code>'utils'</code> adds a new <code>"bibentry"</code> class
for representing and manipulating bibliographic information in
enhanced BibTeX style, unifying and enhancing the previously
existing mechanisms.
</p>
<p>
</li>
<li>A <code>bibstyle()</code> function has been added to the
<code>'tools'</code> package with default JSS style for rendering
<code>"bibentry"</code> objects, and a mechanism for registering other
rendering styles.
</p>
<p>
</li>
<li>Several aspects of the display of text help are now
customizable using the new <code>Rd2txt_options()</code> function.
options(<code>"help_text_width"</code>) is no longer used.
</p>
<p>
</li>
<li>Added <code>\href</code> tag to the Rd format, to allow
hyperlinks to URLs without displaying the full URL.
</p>
<p>
</li>
<li>New <code>toRd()</code> generic in the <code>'tools'</code> package to
convert objects to fragments of Rd code, and added
<code>"fragment"</code> argument to <code>Rd2txt()</code>, <code>Rd2HTML()</code>,
and <code>Rd2latex()</code> to support it.
</p>
<p>
</li>
<li><code>R_HOME/share/texmf</code> now follows the TDS conventions,
so can be set as a <code>texmf</code> tree (&lsquo;root directory&rsquo; in
MiKTeX parlance).
</p>
<p>
</li>
<li>S3 generic functions now use correct S4 inheritance when
dispatching on an S4 object.  See <code>?Methods</code>, section on
&ldquo;Methods for S3 Generic Functions&rdquo; for recommendations
and details.
</p>
<p>
</li>
<li><code>format.pval()</code> gains a <code>...</code> argument to pass
arguments such as <code>'nsmall'</code> to <code>format()</code>.  (Wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=9574">PR#9574</a>)
</p>
<p>
</li>
<li><code>legend()</code> supports <code>'title.adj'</code> (Wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13415">PR#13415</a>)
</p>
<p>
</li>
<li>Added support for subsetting <code>"raster"</code> objects, plus
assigning to a subset, conversion to a matrix (of colour
strings), and comparisons (<code>==</code> and <code>!=</code>).
</p>
<p>
</li>
<li>Added a new <code>parseLatex()</code> function (and related functions
<code>deparseLatex()</code> and <code>latexToUtf8()</code>) to support conversion of
bibliographic entries for display in R.
</p>
<p>
</li>
<li>Text rendering of <code>\itemize</code> in help uses a Unicode
bullet in UTF-8 and most single-byte Windows locales.
</ul>

</p>



<h4>DEPRECATED &amp; DEFUNCT</h4>

<p>

<ul>
<li> Supplying the parser with a string containing both octal/hex and
Unicode escapes is now an error.
</p>
<p>
</li>
<li>File extension <code>.C</code> for C++ code files in packages is
now defunct.
</ul>

</p>



<h4>PACKAGE INSTALLATION</h4>

<p>

<ul>
<li> <code>install.packages()</code> has a new argument
<code>'libs_only'</code> to optionally pass <span class="option">--libs-only</span> to
<CODE>R CMD INSTALL</CODE> and works analogously for Windows binary
installs (to add support for 64- or 32-bit Windows).
</p>
<p>
</li>
<li>When sub-architectures are in use, the installed
architectures are recorded in the <code>'Archs'</code> field of the
<code>DESCRIPTION</code> file.  There is a new default filter,
<code>"subarch"</code>, in <code>available.packages()</code> to make use of
this.
</p>
<p>
Code is compiled in a copy of the <code>'src'</code> directory when a
package is installed for more than one sub-architecture: this
avoid problems with cleaning the sources between building
sub-architectures.
</p>
<p>
</li>
<li><CODE>R CMD INSTALL --libs-only</CODE> no longer overrides the
setting of locking, so a previous version of the package will be
restored unless <span class="option">--no-lock</span> is specified.
</ul>

</p>



<h4>UTILITIES</h4>

<p>

<ul>
<li> <CODE>R CMD Rprof|build|check</CODE> are now based on <font face="Courier New,Courier" color="#666666"><b>R</b></font> rather
than Perl scripts.  The only remaining Perl scripts are the
rarely used <CODE>R CMD Sd2Rd</CODE>, <code>install-info.pl</code> (used only if
<code>install-info</code> is not found) and some maintainer-mode-only scripts.
</p>
<p>
</li>
<li><CODE>R CMD check</CODE> has a new argument <span class="option">--extra-arch</span>
to confine tests to those needed to check an additional
sub-architecture.
</p>
<p>
<CODE>R CMD check</CODE>'s check for &ldquo;Subdirectory 'inst'
contains no files&rdquo; is more thorough: it looks for files, and
warns if there are only empty directories.
</p>
<p>
<code>'check'</code> configuration files have changed format: they are now
<font face="Courier New,Courier" color="#666666"><b>R</b></font> source files, and the default file is <code>~/.R/check.Rconf</code>.
</p>
<p>
</li>
<li><CODE>R CMD build</CODE> no longer creates an <code>INDEX</code> file
(<CODE>R CMD INSTALL</CODE> does so), and <code>--force</code> removes
(rather than overwrites) an existing <code>INDEX</code> file.
</p>
<p>
</li>
<li><CODE>R CMD Rd2dvi</CODE> makes use of <code>tools::texi2dvi()</code>
to process the package manual.
</p>
<p>
</li>
<li><CODE>R CMD Rprof</CODE> now uses <code>utils::summaryRprof()</code>
rather than Perl.  It has new arguments to select one of the
tables and to limit the number of entries printed.
</p>
<p>
</li>
<li><CODE>R CMD Sweave</CODE> now runs <font face="Courier New,Courier" color="#666666"><b>R</b></font> with <code>--vanilla</code> so
the environment setting of <code>R_LIBS</code> will always be used.
</ul>

</p>



<h4>C-LEVEL FACILITIES</h4>

<p>

</p>
<p>
<ul>
<li> <code>lang5()</code> and <code>lang6()</code> (in addition to
pre-existing <code>lang[1-4]()</code>) convenience functions for easier
construction of <code>eval()</code> calls.  If you have your own
definition, do wrap it inside <code>'#ifndef lang5 .... #endif'</code>
to keep it working with old and new <font face="Courier New,Courier" color="#666666"><b>R</b></font>.
</p>
<p>
</li>
<li>Header <code>R.h</code> now includes only the C headers it itself needs,
hence no longer includes <code>errno.h</code>.  (This helps avoid problems
when it is included from C++ source files.)
</p>
<p>
</li>
<li>Headers <code>Rinternals.h</code> and <code>R_ext/Print.h</code> include
the C++ versions of <code>stdio.h</code> and <code>stdarg.h</code>
respectively if included from a C++ source file.
</ul>

</p>



<h4>INSTALLATION</h4>

<p>

<ul>
<li> A C99 compiler is now required, and more C99 language features
will be used in the <font face="Courier New,Courier" color="#666666"><b>R</b></font> sources.
</p>
<p>
</li>
<li>Tcl/Tk >= 8.4 is now required (increased from 8.3).
</p>
<p>
</li>
<li><CODE>'make check'</CODE> compares the output of the examples
from several of the base packages to reference output rather than
the previous output (if any).  Expect some differences due to
differences in floating-point computations.
</p>
<p>
</li>
<li><code>zlib</code> has been updated to 1.2.4: this is also the minimum
version required for <span class="option">--with-system-zlib</span>.
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

<ul>
<li> Calls to <code>selectMethod()</code> by default no longer cache inherited
methods.  This could previously corrupt methods used by <code>as()</code>.
</p>
<p>
</li>
<li>The densities of non-central chi-squared are now more accurate
in some cases in the extreme tails, e.g. <code>dchisq(2000, 2,
       1000)</code>, as a series expansion was truncated too early.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14105">PR#14105</a>)
</p>
<p>
</li>
<li><code>pt()</code> is more accurate in the left tail for <code>ncp</code>
large, e.g. <code>pt(-1000, 3, 200)</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14069">PR#14069</a>)
</p>
<p>
</li>
<li>The default C code (R_binary) for binary ops now sets the S4
bit in the result if either argument is an S4
object.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13209">PR#13209</a>)
</p>
<p>
</li>
<li><code>source(echo=TRUE)</code> failed to echo comments that
followed the last statement in a file.
</p>
<p>
</li>
<li>S4 classes that contained one of <code>"matrix"</code>,
<code>"array"</code> or <code>"ts"</code> and also another class now accept
superclass objects in <code>new()</code>.  Also fixes failure to call
<code>validObject()</code> for these classes.
</p>
<p>
</li>
<li>Conditional inheritance defined by argument <code>test</code> in
<code>methods::setIs()</code> will no longer be used in S4 method
selection (caching these methods could give incorrect results).
See <code>?setIs</code>.
</p>
<p>
</li>
<li>The signature of an implicit generic is now used by
<code>setGeneric()</code> when that does not use a definition nor
explicitly set a signature.
</p>
<p>
</li>
<li>The <code>pdf()</code> device will now allow <code>'lwd'</code> values
less than 1 (it used to force such values to be 1).
</p>
<p>
</li>
<li>A bug in <code>callNextMethod()</code> for some examples with
<code>"..."</code> in the arguments has been fixed.  See
<code>src/library/methods/tests/nextWithDots.R</code> in the sources.
</p>
<p>
</li>
<li><code>GERaster()</code> now checks for width or height of zero and does
nothing in those cases; previously the behaviour was
undefined, probably device-specific, and possibly dangerous.
</p>
<p>
</li>
<li><code>\Sexpr[result=rd]</code> in an <code>Rd</code> file added a
spurious newline, which was displayed as extra whitespace when
rendered.
</ul>

</p>

</p>


<h3>CHANGES IN R VERSION 2.11.1 patched</h3>

<p>


<h4>NEW FEATURES</h4>

<p>

<ul>
<li> <code>install.packages()</code> has a new optional argument
<code>'INSTALL_opts'</code> which can be used to pass options to
<CODE>R CMD INSTALL</CODE> for source-package installs.
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

<ul>
<li> <CODE>R CMD Rd2dvi</CODE> failed if run from a path containing
space(s).  This also affected <CODE>R CMD check</CODE>, which calls
<CODE>Rd2dvi</CODE>.
</p>
<p>
</li>
<li><code>stripchart()</code> could fail with an empty factor
level.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14317">PR#14317</a>)
</p>
<p>
</li>
<li>Text help rendering of <code>\tabular{}</code> has been
improved: under some circumstances leading blank columns were
not rendered.
</p>
<p>
</li>
<li><code>strsplit(x, fixed=TRUE)</code> marked UTF-8 strings with the
local encoding when no splits were found.
</p>
<p>
</li>
<li><code>weighted.mean(NA, na.rm=TRUE)</code> and similar now returns
<code>NaN</code> again, as it did prior to <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.10.0.
</ul>

</p>

</p>


<h3>CHANGES IN R VERSION 2.11.1</h3>

<p>


<h4>NEW FEATURES</h4>

<p>

<ul>
<li> <CODE>R CMD INSTALL</CODE> checks if dependent packages are
available early on in the installation of source packages,
thereby giving clearer error messages.
</p>
<p>
</li>
<li><CODE>R CMD INSTALL --build</CODE> now names the file in the
format used for Mac OS X binary files on that platform.
</p>
<p>
</li>
<li><code>BIC()</code> in package stats4 now also works with multiple
fitted models, analogously to <code>AIC()</code>.
</ul>

</p>



<h4>DEPRECATED &amp; DEFUNCT</h4>

<p>

<ul>
<li> Use of file extension <code>.C</code> for C++ code in packages is now
deprecated: it has caused problems for some <CODE>make</CODE>s on
case-insensitive file systems (although it currently works
with the recommended toolkits).
</ul>

</p>



<h4>INSTALLATION</h4>

<p>

<ul>
<li> Command <CODE>'gnutar'</CODE> is preferred to <CODE>'tar'</CODE>
when configure sets <code>TAR</code>.  This is needed on Mac OS 10.6,
where the default <code>tar</code>, <code>bsdtar 2.6.2</code>, has been
reported to produce archives with illegal extensions to tar
(according to the POSIX standard).
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

<ul>
<li> The C function <code>mkCharLenCE</code> now no longer reads past
<code>'len'</code> bytes (unlikely to be a problem except in user
code).  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14246">PR#14246</a>)
</p>
<p>
</li>
<li>On systems without any default <code>LD_LIBRARY_PATH</code> (not
even <code>/usr/local/lib</code>), <code>[DY]LIB_LIBRARY_PATH</code> is now
set without a trailing colon.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13637">PR#13637</a>)
</p>
<p>
</li>
<li>More efficient <code>utf8ToInt()</code> on long multi-byte strings
with many multi-byte characters.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14262">PR#14262</a>)
</p>
<p>
</li>
<li><code>aggregate.ts()</code> gave platform-dependent results due to
rounding error for <code>ndeltat != 1</code>.
</p>
<p>
</li>
<li><code>package.skeleton()</code> sometimes failed to fix filenames
for <code>.R</code> or <code>.Rd</code> files to start with an alphanumeric.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14253">PR#14253</a>)
</p>
<p>
It also failed when only an S4 class without any methods was
defined.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14280">PR#14280</a>)
</p>
<p>
</li>
<li><code>splinefun(*, method = <code>"monoH.FC"</code>)</code> was not
quite monotone in rare cases.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14215">PR#14215</a>)
</p>
<p>
</li>
<li><code>Rhttpd</code> no longer crashes due to <code>SIGPIPE</code> when
the client closes the connection prematurely.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14266">PR#14266</a>)
</p>
<p>
</li>
<li><code>format.POSIXlt()</code> could cause a stack overflow and
crash when used on very long vectors.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14267">PR#14267</a>)
</p>
<p>
</li>
<li><code>Rd2latex()</code> incorrectly escaped special characters in
<code>\usage</code> sections.
</p>
<p>
</li>
<li><code>mcnemar.test()</code> could alter the levels (dropping
unused levels) if passed <code>'x'</code> and <code>'y'</code> as factors
(reported by Greg Snow).
</p>
<p>
</li>
<li><CODE>Rd2pdf</CODE> sometimes needed a further
<CODE>pdflatex</CODE> pass to get hyperlinked pages correct.
</p>
<p>
</li>
<li><code>interaction()</code> produced malformed results when levels were
duplicated, causing segfaults in <code>split()</code>.
</p>
<p>
</li>
<li><code>cut(d, breaks = &lt;n&gt;)</code> now also works for <code>"Date"</code>
or <code>"POSIXt"</code> argument <code>d</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14288">PR#14288</a>)
</p>
<p>
</li>
<li><code>memDecompress()</code> could decompress incompletely rare
<code>xz</code>-compressed input due to incorrect documentation of
<CODE>xz utils</CODE>.  (Report and patch from Olaf Mersmann.)
</p>
<p>
</li>
<li>The S4 <code>initialize()</code> methods for <code>"matrix"</code>,
<code>"array"</code>, and <code>"ts"</code> have been fixed to call
<code>validObject()</code>.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14284">PR#14284</a>)
</p>
<p>
</li>
<li><CODE>R CMD INSTALL</CODE> now behaves the same way with or
without <span class="option">--no-multiarch</span> on platforms with only one
installed architecture.  (It used to clean the src directory
without <span class="option">--no-multiarch</span>.)
</p>
<p>
</li>
<li><code>[&lt;-.data.frame</code> was not quite careful enough in
assigning (and potentially deleting) columns
right-to-left.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14263">PR#14263</a>)
</p>
<p>
</li>
<li><code>rbeta(n, a, b)</code> no longer occasionally returns
<code>NaN</code> for <code>a &gt;&gt; 1 &gt; b</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14291">PR#14291</a>)
</p>
<p>
</li>
<li><code>pnorm(x, log.p = TRUE)</code> could return <code>NaN</code> not
<code>-Inf</code> for <code>x</code> near (minus for <code>lower.tail=TRUE</code>)
the largest representable number.
</p>
<p>
</li>
<li>Compressed data files <code>*.(txt|tab|csv).(gz|bz2|xz)</code>
were not recognized for the list of data topics and hence for
packages using <code>LazyData</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14273">PR#14273</a>)
</p>
<p>
</li>
<li><code>textConnection()</code> did an unnecessary translation on
strings in a foreign encoding (e.g. UTF-8 strings on Windows) and
so was slower than it could have been on very long input strings.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14286">PR#14286</a>)
</p>
<p>
</li>
<li><code>tools::Rd2txt()</code> did not render poorly written Rd
files consistently with other renderers.
</p>
<p>
It computed widths of strings that would be <code>print()</code>ed with
escapes incorrectly, for example in the computation of column
width for <code>\tabular</code>.
</p>
<p>
</li>
<li><code>na.action()</code> did not extract the <code>'na.action'</code>
component as documented.
</ul>

</p>

</p>


<h3>CHANGES IN R VERSION 2.11.0</h3>

<p>


<h4>SIGNIFICANT USER-VISIBLE CHANGES</h4>

<p>

<ul>
<li> Packages must have been installed under <font face="Courier New,Courier" color="#666666"><b>R</b></font> &gt;= 2.10.0, as the
current help system is the only one now supported.
</p>
<p>
</li>
<li>A port to 64-bit Windows is now available as well as binary
package repositiories: see the &lsquo;R Administration and
Installation Manual&rsquo;.
</p>
<p>
</li>
<li>Argument matching for primitive functions is now done in the
same way as for interpreted functions except for the deliberate
exceptions
<pre>
	 call switch .C .Fortran .Call .External
       </pre>
all of which use positional matching for their first argument,
and also some internal-use-only primitives.
</p>
<p>
</li>
<li>The default device for command-line <font face="Courier New,Courier" color="#666666"><b>R</b></font> at the console on Mac OS X
is now <code>quartz()</code> and not <code>X11()</code>.
</ul>

</p>



<h4>NEW FEATURES</h4>

<p>

<ul>
<li> The <code>'open'</code> modes for connections are now interpreted more
consistently.  <code>open = "r"</code> is now equivalent to <code>open =
       "rt"</code> for all connections.  The default open = <code>""</code>
now means <code>"rt"</code> for all connections except the compressed
file connections <code>gzfile()</code>, <code>bzfile()</code> and
<code>xzfile()</code> for which it means <code>"rb"</code>.
</p>
<p>
</li>
<li><CODE>R CMD INSTALL</CODE> now uses the internal <code>untar()</code>
in package utils: this ensures that all platforms can install
<CODE>bzip2</CODE>- and <CODE>xz</CODE>-compressed tarballs.  In case
this causes problems (as it has on some Windows file systems when
run from Cygwin tools) it can be overridden by the environment
variable <code>R_INSTALL_TAR</code>: setting this to a modern external
tar program will speed up unpacking of large (tens of Mb or more)
tarballs.
</p>
<p>
</li>
<li><code>help(try.all.packages = TRUE)</code> is much faster
(although the time taken by the OS to find all the packages the
first time it is used can dominate the time).
</p>
<p>
</li>
<li><CODE>R CMD check</CODE> has a new option <span class="option">'--timings'</span>
to record per-example timings in file
<code>&lt;pkg&gt;.Rcheck/&lt;pkg&gt;-Ex.timings</code>.
</p>
<p>
</li>
<li>The TRE library has been updated to version 0.8.0 (minor bugfixes).
</p>
<p>
</li>
<li><code>grep[l]</code>, <code>[g]sub</code> and <code>[g]regexpr</code> now work
in bytes in an 8-bit locales if there is no marked UTF-8 input
string: this will be somewhat faster, and for <code>[g]sub()</code>
give the result in the native encoding rather than in UTF-8
(which returns to the behaviour prior to <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.10.0).
</p>
<p>
</li>
<li>A new argument <code>'skipCalls'</code> has been added to
<code>browser()</code> so that it can report the original context when
called by other debugging functions.
</p>
<p>
</li>
<li>More validity checking of UTF-8 and MBCS strings is done by
<code>agrep()</code> and the regular-expression matching functions.
</p>
<p>
</li>
<li>The undocumented restriction on <code>gregexpr()</code> to
length(text) &gt; 0 has been removed.
</p>
<p>
</li>
<li>Package <code>tcltk</code> now sends strings to Tcl in UTF-8: this
means that strings with a marked UTF-8 encoding are supported in
non-UTF-8 locales.
</p>
<p>
</li>
<li>The graphics engine now supports rendering of raster (bitmap)
images, though not all graphics devices can provide (full)
support.  Packages providing graphics devices (e.g., <code>Cairo</code>,
<code>RSvgDevice</code>, <code>cairoDevice</code>) will need to be reinstalled.
</p>
<p>
There is also support in the graphics engine for capturing
raster images from graphics devices (again not supported
on all graphics devices).
</p>
<p>
</li>
<li><CODE>R CMD check</CODE> now also checks if the package and
namespace can be unloaded: this provides a check of the
<code>.Last.lib()</code> and <code>.onUnload()</code> hook functions (unless
<span class="option">--install=fake</span>).
</p>
<p>
</li>
<li><code>prop.table(x)</code> now accepts a one-dimensional table for
<code>x</code>.
</p>
<p>
</li>
<li>A new function <code>vapply()</code> has been added, based on a
suggestion from Bill Dunlap.  It requires that a template for the
function value be specified, and uses it to determine the output
type and to check for consistency in the function values.
</p>
<p>
</li>
<li>The main HTML help page now links to a reformatted copy of
this <code>NEWS</code> file.  (Suggested by Henrik Bengtsson.)  Package
index files link to the package <code>DESCRIPTION</code> and
<code>NEWS</code> files and a list of demos when using dynamic help.
</p>
<p>
</li>
<li>The <code>[</code> method for class <code>"AsIs"</code> allows the next
method to change the underlying class.  (Wish of Jens
Oehlschlägel.)
</p>
<p>
</li>
<li><code>write.csv[2]</code> no longer allow <code>'append'</code> to be
changed: as ever, direct calls to <code>write.table()</code> give more
flexibility as well as more room for error.
</p>
<p>
</li>
<li>The index page for HTML help for a package now collapses
multiple signatures for S4 methods into a single entry.
</p>
<p>
</li>
<li>The use of <code>'.required'</code> by <code>require()</code> and
<code>detach()</code> has been replaced by <code>'.Depends'</code> which is
set from the <code>'Depends'</code> field of a package (even in
packages with name spaces).  By default <code>detach()</code> prevents
such dependencies from being detached: this can be overridden by
the argument <code>'force'</code>.
</p>
<p>
</li>
<li><code>bquote()</code> has been extended to work on function
definitions.  (Wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14031">PR#14031</a>).
</p>
<p>
</li>
<li><code>detach()</code> when applied to an object other than a package
returns the environment that has been detached, to parallel
<code>attach()</code>.
</p>
<p>
</li>
<li><code>readline()</code> in non-interactive use returns <code>""</code>
and does not attempt to read from the &lsquo;terminal&rsquo;.
</p>
<p>
</li>
<li>New function <code>file_ext()</code> in package <code>'tools'</code>.
</p>
<p>
</li>
<li><code>xtfrm()</code> is now primitive and internally generic, as
this allows S4 methods to be set on it without name-space scoping
issues.
</p>
<p>
There are now <code>"AsIs"</code> and <code>"difftime"</code> methods, and
the default method uses <code>unclass(x)</code> if <code>is.numeric(x)</code>
is true (which will be faster but relies on <code>is.numeric()</code>
having been set correctly for the class).
</p>
<p>
</li>
<li><code>is.numeric(x)</code> is now false for a <code>"difftime"</code>
object (multiplication and division make no sense for such
objects).
</p>
<p>
</li>
<li>The default method of <code>weighted.mean(x, w)</code> coerces
<code>'w'</code> to be numeric (aka double); previously only integer
weights were coerced.  Zero weights are handled specially so an
infinite value with zero weight does not force an <code>NaN</code>
result.
</p>
<p>
There is now a <code>"difftime"</code> method.
</p>
<p>
</li>
<li><code>bug.report()</code> now has <code>'package'</code> and
<code>'lib.loc'</code> arguments to generate bug reports about
packages.  When this is used, it looks for a <code>BugReports</code>
field in the package <code>DESCRIPTION</code> file, which will be
assumed to be a URL at which to submit the report, and otherwise
generates an email to the package maintainer.  (Suggested by
Barry Rowlingson.)
</p>
<p>
</li>
<li><code>quantile()</code> now has a method for the date-time class
<code>"POSIXt"</code>, and types 1 and 3 (which never interpolate) work
for Dates and ordered factors.
</p>
<p>
</li>
<li><code>length(&lt;POSIXlt&gt;)</code> now returns the length of the
corresponding abstract timedate-vector rather than always 9 (the
length of the underlying list structure).  (Wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14073">PR#14073</a> and
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=10507">PR#10507</a>.)
</p>
<p>
</li>
<li>The <code>readline</code> completion backend no longer sorts
possible completions alphabetically (e.g., function argument
names) if <font face="Courier New,Courier" color="#666666"><b>R</b></font> was built with <code>readline &gt;= 6</code>.
</p>
<p>
</li>
<li><code>select.list()</code> gains a <code>'graphics'</code> argument to
allow Windows/Mac users to choose the text interface.  This
changes the behaviour of <code>new.packages(ask=TRUE)</code> to be like
<code>update.packages(ask=TRUE)</code> on those platforms in using a
text menu: use ask=<code>"graphics"</code> for a graphical menu.
</p>
<p>
</li>
<li>New function <code>chooseBioCmirror()</code> to set the
<code>"BioC_mirror"</code> option.
</p>
<p>
</li>
<li>The <font face="Courier New,Courier" color="#666666"><b>R</b></font> grammar now prevents using the argument <code>'name'</code>
in signatures of S4 methods for <code>$</code> and <code>$&lt;-</code>, since
they will always be called with a character string value for
<code>'name'</code>.  The implicit S4 generic functions have been
changed to reflect this: packages which included <code>'name'</code> in
the signature of their methods need to be updated and
re-installed.
</p>
<p>
</li>
<li>The handling of the <code>'method'</code> argument of <code>glm()</code>
has been refined following suggestions by Ioannis Kosmidis and
Heather Turner.
</p>
<p>
</li>
<li><code>str()</code> gains a new argument <code>'list.len'</code> with
default 99, limiting the number of <code>list()</code> items (per
level), thanks to suggestions from David Winsenius.
</p>
<p>
</li>
<li>Having formal arguments of an S4 method in a different order
from the generic is now an error (the warning having been
ignored by some package maintainers for a long time).
</p>
<p>
</li>
<li>New functions <code>enc2native()</code> and <code>enc2utf8()</code>
convert character vectors with possibly marked encodings to the
current locale and UTF-8 respectively.
</p>
<p>
</li>
<li>Unrecognized escapes and embedded nuls in character strings are
now an error, not just a warning.  Thus option <code>"warnEscapes"</code>
is no longer needed.  <code>rawToChar()</code> now removes trailing nuls
silently, but other embedded nuls become errors.
</p>
<p>
</li>
<li>Informational messages about masked objects displayed when a
package is attached are now more compact, using <code>strwrap()</code>
instead of one object per line.
</p>
<p>
</li>
<li><code>print.rle()</code> gains argument <code>'prefix'</code>.
</p>
<p>
</li>
<li><code>download.file()</code> gains a <code>"curl"</code> method, mainly
for use on platforms which have <CODE>'curl'</CODE> but not
<CODE>'wget'</CODE>, but also for some hard-to-access URLs.
</p>
<p>
</li>
<li>In <code>Rd</code>, <code>\eqn</code> and <code>\deqn</code> will render in
HTML (and convert to text) upper- and lower-case Greek letters
(entered as <code>\alpha</code> ...), <code>\ldots</code>, <code>\dots</code>,
<code>\ge</code> and <code>\le</code>.
</p>
<p>
</li>
<li><code>utf8ToInt()</code> and <code>intToUtf8()</code> now map <code>NA</code> inputs
to <code>NA</code> outputs.
</p>
<p>
</li>
<li><code>file()</code> has a new argument <code>'raw'</code> which may help
if it is used with something other than a regular file, e.g. a
character device.
</p>
<p>
</li>
<li>New function <code>strtoi()</code>, a wrapper for the C function
<code>strtol</code>.
</p>
<p>
</li>
<li><code>as.octmode()</code> and <code>as.hexmode()</code> now allow inputs
of length other than one.
</p>
<p>
The <code>format()</code> and <code>print()</code> methods for
<code>"octmode"</code> now preserve names and dimensions (as those for
<code>"hexmode"</code> did).
</p>
<p>
The <code>format()</code> methods for classes <code>"octmode"</code> and
<code>"hexmode"</code> gain a <code>'width'</code> argument.
</p>
<p>
</li>
<li><code>seq.int()</code> returns an integer result in some further cases
where <code>seq()</code> does, e.g. <code>seq.int(1L, 9L, by = 2L)</code>.
</p>
<p>
</li>
<li>Added <code>\subsection{}{}</code> macro to Rd syntax, for
subsections within sections.
</p>
<p>
</li>
<li>n-dimensional arrays with dimension names can now be indexed
by an n-column character matrix.  The indices are matched against
the dimension names.  <code>NA</code> indices are propagated to the
result.  Unmatched values and <code>""</code> are not allowed and
result in an error.
</p>
<p>
</li>
<li><code>interaction(drop=TRUE)</code> uses less memory (related to
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14121">PR#14121</a>).
</p>
<p>
</li>
<li><code>summary()</code> methods have been added to the
<code>"srcref"</code> and <code>"srcfile"</code> classes, and various
encoding issues have been cleaned up.
</p>
<p>
</li>
<li>If option <code>"checkPackageLicense"</code> is set to <code>TRUE</code> (not
currently the default), users will be asked to agree to
non-known-to-be-FOSS package licences at first use.
</p>
<p>
</li>
<li>Checking <code>setAs(a, b)</code> methods only gives a message
instead of a warning, when one of <code>a</code> or <code>b</code> is
unknown.
</p>
<p>
</li>
<li>New function <code>norm()</code> to compute a matrix norm.
<code>norm()</code> and also <code>backsolve()</code> and <code>sample()</code>
have implicit S4 generics.
</p>
<p>
</li>
<li><code>Renviron.site</code> and <code>Rprofile.site</code> can have
architecture-specific versions on systems with sub-architectures.
</p>
<p>
</li>
<li><CODE>R CMD check</CODE> now (by default) also checks <code>Rd</code>
files for auto-generated content in need of editing, and missing
argument descriptions.
</p>
<p>
</li>
<li><code>aggregate()</code> gains a formula method thanks to a
contribution by Arni Magnusson.  The data frame method now allows
summary functions to return arbitrarily many values.
</p>
<p>
</li>
<li><code>path.expand()</code> now propagates <code>NA</code> values rather
than converting them to <code>"NA"</code>.
</p>
<p>
</li>
<li><code>file.show()</code> now disallows <code>NA</code> values for file names,
headers, and pager.
</p>
<p>
</li>
<li>The &lsquo;fuzz&rsquo; used by <code>seq()</code> and <code>seq.int()</code> has
been reduced from <code>1e-7</code> to <code>1e-10</code>, which should be
ample for the double-precision calculations used in <font face="Courier New,Courier" color="#666666"><b>R</b></font>.  It
ensures that the fuzz never comes into play with sequences of
integers (wish of <a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14169">PR#14169</a>).
</p>
<p>
</li>
<li>The default value of <code>RSiteSearch(restrict=)</code> has been
changed to include vignettes but to exclude R-help.  The R-help
archives available have been split, with a new option of
<code>"Rhelp10"</code> for those from 2010.
</p>
<p>
</li>
<li>New function <code>rasterImage()</code> in the <code>'graphics'</code>
package for drawing raster images.
</p>
<p>
</li>
<li><code>stats:::extractAIC.coxph()</code> now omits aliased terms
when computing the degrees of freedom (suggestion of Terry
Therneau).
</p>
<p>
</li>
<li><code>cor()</code> and <code>cov()</code> now test for misuse with
non-numeric arguments, such as the non-bug report
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14207">PR#14207</a>.
</p>
<p>
</li>
<li><code>pchisq(ncp =, log.p = TRUE)</code> is more accurate for
probabilities near one.  E.g. <code>pchisq(80, 4, ncp=1,
       log.p=TRUE)</code>.  (Maybe what was meant in
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14216">PR#14216</a>.)
</p>
<p>
</li>
<li><code>maintainer()</code> has been added, to give convenient
access to the name of the maintainer of a package (contributed by
David Scott).
</p>
<p>
</li>
<li><code>sample()</code> and <code>sample.int()</code> allow zero items to
be sampled from a zero-length input.  <code>sample.int()</code> gains a
default value <code>'size=n'</code> to be more similar to <code>sample()</code>.
</p>
<p>
</li>
<li><code>switch()</code> returned <code>NULL</code> on error (not
previously documented on the help page): it now does so
invisibly, analogously to if-without-else.
</p>
<p>
It is now primitive: this means that argument <code>EXPR</code> is
always matched to the first argument and there is no danger of
partial matching to later named arguments.
</p>
<p>
</li>
<li>Primitive functions <code>UseMethod()</code>, <code>attr()</code>,
<code>attr&lt;-()</code>, <code>on.exit()</code>, <code>retracemem()</code> and
<code>substitute()</code> now use standard argument matching (rather
than positional matching).  This means that all multi-argument
primitives which are not internal now use standard argument
matching except where positional matching is desirable (as for
<code>switch()</code>, <code>call()</code>, <code>.C()</code> ...).
</p>
<p>
</li>
<li>All the one-argument primitives now check that any name
supplied for their first argument is a partial match to the
argument name as documented on the help page: this also
applies to replacement functions of two arguments.
</p>
<p>
</li>
<li><code>base::which()</code> uses a new <code>.Internal</code> function
when <code>arr.ind</code> is <code>FALSE</code> resulting in a 10x speedup.
Thanks to Patrick Aboyoun for implementation suggestions.
</p>
<p>
</li>
<li>Help conversion to text now uses the first part of
<code>\enc{}{}</code> markup if it is representable in the current
output encoding.  On the other hand, conversion to LaTeX with the
default <code>outputEncoding = "ASCII"</code> uses the second part.
</p>
<p>
</li>
<li>A new class <code>"listOfMethods"</code> has been introduced to represent
the methods in a methods table, to replace the deprecated
class <code>"MethodsList"</code>.
</p>
<p>
</li>
<li><code>any()</code> and <code>all()</code> return early if possible.
This may speed up operations on long vectors.
</p>
<p>
</li>
<li><code>strptime()</code> now accepts <code>"%z"</code> (for the offset
from UTC in the RFC822 format of <code>+/-hhmm</code>).
</p>
<p>
</li>
<li>The PCRE library has been updated to version 8.02, a bug-fix
release which also updates tables to Unicode 5.02.
</p>
<p>
</li>
<li>Functions which may use a graphical <code>select.list()</code>
(including <code>menu()</code> and <code>install.packages()</code>) now check
on a Unix-alike that Tk can be started (and not just
<code>capabilities("tcltk") &amp;&amp; capabilities("X11")</code>).
</p>
<p>
</li>
<li>The parser no longer marks strings containing octal or hex
escapes as being in UTF-8 when entered in a UTF-8 locale.
</p>
<p>
</li>
<li>On platforms with cairo but not Pango (notably Mac OS X) the
initial default <code>X11()</code> type is set to <code>"Xlib"</code>: this avoids
several problems with font selection when done by cairo rather
than Pango (at least on Mac OS X).
</p>
<p>
</li>
<li>New function <code>arrayInd()</code> such that <code>which(x,
       arr.ind = TRUE)</code> for an array 'x' is now equivalent to
<code>arrayInd(which(x), dim(x), dimnames(x))</code>.
</ul>

</p>



<h4>DEPRECATED &amp; DEFUNCT</h4>

<p>

<ul>
<li> Bundles of packages are defunct.
</p>
<p>
</li>
<li><code>stats::clearNames()</code> is defunct: use <code>unname()</code>.
</p>
<p>
</li>
<li>Basic regular expressions are defunct, and
<code>strsplit()</code>, <code>grep()</code>, <code>grepl()</code>, <code>sub()</code>,
<code>gsub()</code>, <code>regexpr()</code> and <code>gregexpr()</code> no longer
have an <code>'extended'</code> argument.
</p>
<p>
</li>
<li><code>methods::trySilent()</code> is defunct.
</p>
<p>
</li>
<li><code>index.search()</code> (which was deprecated in 2.10.0) is no
longer exported and has a different argument list.
</p>
<p>
</li>
<li>Use of multiple arguments to <code>return()</code> is now defunct.
</p>
<p>
</li>
<li>The use of <code>UseMethod()</code> with more than two arguments
is now defunct.
</p>
<p>
</li>
<li>In the <code>'methods'</code> package, the <code>"MethodsList"</code>
metadata objects which had been superseded by hash tables
(environments) since <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.8.0 are being phased out.  Objects of
this class are no longer assigned or used as metadata by the
package.
</p>
<p>
<code>getMethods()</code> is now deprecated, with its internal use replaced
by <code>findMethods()</code> and other changes.  Creating objects from the
<code>"MethodsList"</code> class is also deprecated.
</p>
<p>
</li>
<li>Parsing strings containing both octal/hex and Unicode escapes
now gives a warning and will become an error in <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.12.0.
</ul>

</p>



<h4>INSTALLATION</h4>

<p>

<ul>
<li> UTF-8 is now used for the reference manual and package
manuals.  This requires LaTeX &lsquo;2005/12/01&rsquo; or later.
</p>
<p>
</li>
<li><CODE>configure</CODE> looks for a POSIX compliant
<CODE>tr</CODE>, Solaris's <CODE>/usr/ucb/tr</CODE> having been found
to cause <CODE>Rdiff</CODE> to malfunction.
</p>
<p>
</li>
<li><CODE>configure</CODE> is now generated with <CODE>autoconf
       2.65</CODE>, which works better on recent systems and on Mac OS X.
</ul>

</p>



<h4>PACKAGE INSTALLATION</h4>

<p>

<ul>
<li> Characters in <font face="Courier New,Courier" color="#666666"><b>R</b></font> source which are not translatable to the
current locale are now handled more tolerantly:  these will be
converted to hex codes with a warning.  Such characters are
only really portable if they appear in comments.
</p>
<p>
</li>
<li><CODE>R CMD INSTALL</CODE> now tests that the installed package
can be loaded (and backs out the installation if it cannot): this
can be suppressed by <span class="option">--no-test-load</span>.  This avoids
installing/updating a package that cannot be used: common causes
of failures to load are missing/incompatible external software
and missing/broken dependent packages.
</p>
<p>
</li>
<li>Package installation on Windows for a package with a
<code>src</code> directory now checks if a DLL is created unless there
is a <code>src/Makefile.win</code> file: this helps catch broken
installations where the toolchain has not reported problems in
building the DLL.  (Note: this can be any DLL, not just one named
<code>&lt;pkg-name&gt;.dll</code>.)
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

</p>
<p>
<ul>
<li> Using <code>with()</code>, <code>eval()</code> etc with a list with some
unnamed elements now works.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14035">PR#14035</a>)
</p>
<p>
</li>
<li>The <code>"quick"</code> dispatch of S4 methods for primitive
functions was not happening, forcing a search each time.
(Dispatch for closures was not affected.)  A side effect is that
default values for arguments in a method that do not have
defaults in the generic will now be ignored.
</p>
<p>
</li>
<li>Trying to dispatch S4 methods for primitives during the search
for inherited methods slows that search down and potentially
could cause an infinite recursion.  An internal switch was
added to turn off all such methods from
<code>findInheritedMethods()</code>.
</p>
<p>
</li>
<li><font face="Courier New,Courier" color="#666666"><b>R</b></font> framework installation (on Mac OS X) would not work
properly if a rogue <code>Resources</code> directory was present at the
top level.  Such a non-symlink will now be renamed to
<code>Resources.old</code> (and anything previously named
<code>Resources.old</code> removed) as part of the framework
installation process.
</p>
<p>
</li>
<li>The checks for conforming S4 method arguments could fail
when the signature of the generic function omitted some of the
formal arguments (in addition to <code>...</code>).  Arguments omitted
from the method definition but conforming (per the documentation)
should now be ignored (treated as <code>"ANY"</code>) in dispatching.
</p>
<p>
</li>
<li>The computations for S4 method evaluation when <code>'...'</code>
was in the signature could fail, treating <code>'...'</code> as an
ordinary symbol.  This has been fixed, for the known cases.
</p>
<p>
</li>
<li>Various <code>ar()</code> fitting methods have more protection for
singular fits.
</p>
<p>
</li>
<li><code>callNextMethod</code> now works again with the <code>drop=</code>
argument in <code>`[`</code>
</p>
<p>
</li>
<li><code>parse()</code> and <code>parse_Rd()</code> miscounted columns when
multibyte UTF-8 characters were present.
</p>
<p>
</li>
<li>Formatting of help pages has had minor improvements: extra
blank lines have been removed from the text format, and empty
package labels removed from HTML.
</p>
<p>
</li>
<li><code>cor(A, B)</code> where <code>A</code> is <i>n x 1</i> and <code>B</code>
a 1-dimensional array segfaulted or gave an internal error.  (The
case <code>cor(B, A)</code> was
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=7116">PR#7116</a>.)
</p>
<p>
</li>
<li><code>cut.POSIXt()</code> applied to a start value after the DST
transition on a DST-change day could give the wrong time for
<code>'breaks'</code> in units of days or longer.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14208">PR#14208</a>)
</p>
<p>
</li>
<li><code>do_par()</code> <code>UNPROTECT</code>ed too early
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14214">PR#14214</a>)
</p>
<p>
</li>
<li>Subassignment <code>x[[....]] &lt;- y</code> didn't check for a
zero-length right hand side, and inserted a rubbish
value.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14217">PR#14217</a>)
</p>
<p>
</li>
<li><code>fisher.test()</code> no longer gives a P-value *very* slightly &gt; 1,
in some borderline cases.
</p>
<p>
</li>
<li>Internal function <code>matchArgs()</code> no longer modifies the
general purpose bits of the <code>SEXP</code>s that make up the formals
list of <font face="Courier New,Courier" color="#666666"><b>R</b></font> functions.  This fixes an invalid error message that
would occur when a garbage collection triggered a second call to
matchArgs for the same function via a finalizer.
</p>
<p>
</li>
<li><code>gsub()</code> in 2.10.x could fail from stack overflow for
extremely long strings due to temporary data being allocated on
the stack.  Also, <code>gsub()</code> with <code>fixed=TRUE</code> is in some
circumstances considerably faster.
</p>
<p>
</li>
<li>Several primitives, including <code>attributes()</code>,
<code>attr&lt;-()</code> <code>interactive()</code>, <code>nargs()</code> and
<code>proc.time()</code>, did not check that they were called with the
correct number of arguments.
</p>
<p>
</li>
<li>A potential race condition in <code>list.files()</code> when other
processes are operating on the directory has been fixed; the code
now dynamically allocates memory for file listings in a single
pass instead of making an initial count pass.
</p>
<p>
</li>
<li><code>mean(x, trim=, na.rm = FALSE)</code> failed to return <code>NA</code> if
<code>x</code> contained missing values.  (Reported by Bill Dunlap.)
</p>
<p>
</li>
<li>Extreme tail behavior of, <code>pbeta()</code> {and hence
<code>pf()</code>}, e.g., <code>pbeta(x, 3, 2200, lower.tail=FALSE,
       log.p=TRUE)</code> now returns finite values instead of jumping to
<code>-Inf</code> too early
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14230">PR#14230</a>).
</p>
<p>
</li>
<li><code>parse(text=x)</code> misbehaved for objects <code>'x'</code> that
were not coerced internally to character, notably symbols.
(Reported to R-devel by Bill Dunlap.)
</p>
<p>
</li>
<li>The internal C function <code>'coerceSymbol'</code> now handles
coercion to character, and warns if coercion fails (rather than
silently returning <code>NULL</code>).  This allows a name to be given
where a character vector is required in functions which coerce
internally.
</p>
<p>
</li>
<li>The interpretation by <code>strptime()</code> of <code>"%c"</code> was
non-standard (not that it is ever advisable to use locale- and
system-specific input formats).
</p>
<p>
</li>
<li>capabilities(<code>"X11"</code>) now works the same way on Mac OS X as on
other platforms (and as documented: it was always true for R
built with <span class="option">--with-aqua</span>, as the CRAN builds are).
</p>
<p>
</li>
<li>The <code>X11()</code> device with cairo but not Pango (notably Mac OS X)
now checks validity of text strings in UTF-8 locales (since
Pango does but cairo it seems does not).
</p>
<p>
</li>
<li><code>read.fwf()</code> misread multi-line records when n was specified.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14241">PR#14241</a>)
</p>
<p>
</li>
<li><code>all.equal(*, tolerance = e)</code> passes the numeric
tolerance also to the comparison of the attributes.
</p>
<p>
</li>
<li><code>pgamma(0, 0)</code>, a boundary case, now returns 0, its
limit from the left, rather than the limit from the right.
</p>
<p>
</li>
<li>Issuing <code>POST</code> requests to the internal web server could stall
the request under certain circumstances.
</p>
<p>
</li>
<li><code>gzcon( &lt;textConnection&gt; )</code>, an error, no longer
damages the connection (in a way to have it
segfault).  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14237">PR#14237</a>)
</p>
<p>
</li>
<li>All the results from <code>hist()</code> now use the nominal
<code>'breaks'</code> not those adjusted by the numeric &lsquo;fuzz&rsquo;:
in recent versions the nominal <code>'breaks'</code> were reported but
the 'density' referred to the intervals used in the calculation
&ndash; which mattered very slightly for one of the extreme bins.
(Based on a report by Martin Becker.)
</p>
<p>
</li>
<li>If <code>xy[z].coords</code> (used internally by many graphics
functions) are given a list as <code>'x'</code>, they now check that
the list has suitable names and give a more informative error
message.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13936">PR#13936</a>)
</ul>

</p>

</p>


<h3>CHANGES IN R VERSION 2.10.1 patched</h3>

<p>


<h4>NEW FEATURES</h4>

<p>

<ul>
<li> The handling of line textures in the <code>postscript()</code> and
<code>pdf()</code> devices was set up for round end caps (the only type
which existed at the time): it has now been adjusted for butt
endcaps.
</p>
<p>
</li>
<li><code>lchoose(a, k)</code> is now defined as
<code>log(abs(choose(a,k)))</code>, analogously to <code>lfactorial()</code>.
</p>
<p>
</li>
<li>Although <code>\eqn{}</code> in Rd files is defined as a
&lsquo;verbatim&rsquo; macro, many packages expected <code>\dots</code> and
<code>\ldots</code> to be interpreted there (as was the case in <font face="Courier New,Courier" color="#666666"><b>R</b></font> &lt;
2.10.0), so this is now done (using an ellipsis in HTML
rendering).
</p>
<p>
</li>
<li>Escaping of braces in quoted strings in <font face="Courier New,Courier" color="#666666"><b>R</b></font>-code sections of
Rd files is allowed again.  This had been changed for the new Rd
format in <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.10.0 but was only documented on the developer site
and was handled inconsistently by the converters: text and
example conversion removed the escapes but HTML conversion did
not.
</p>
<p>
</li>
<li>The PCRE library has been updated to version 8.01, a bug-fix
release.
</p>
<p>
</li>
<li><code>tools::readNEWS()</code> now accepts a digit as the first
character of a news section.
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

<ul>
<li> Using <code>read.table(header=TRUE)</code> on a header with an embedded
new line would copy part of the header into the data.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14103">PR#14103</a>)
</p>
<p>
</li>
<li><code>qpois(p = 1, lambda = 0)</code> now gives 0 as for all other
<code>p</code>.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14135">PR#14135</a>)
</p>
<p>
</li>
<li>Functions related to string comparison
(e.g. <code>unique()</code>, <code>match()</code>) could cause crashes when
used with strings not in the native encoding, e.g. UTF-8 strings
on Windows.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14114">PR#14114</a> and
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14125">PR#14125</a>)
</p>
<p>
</li>
<li><code>x[ , drop=TRUE]</code> dropped an <code>NA</code> level even if it
was in use.
</p>
<p>
</li>
<li>The dynamic HTML help system reported the wrong MIME type for the
style sheet.
</p>
<p>
</li>
<li><code>tools::codoc()</code> (used by <CODE>R CMD check</CODE>) was
missing cases where the function had no arguments but was
documented to have some.
</p>
<p>
</li>
<li>Help links containing special characters (e.g. <code>"?"</code>)
were not generated correctly when rendered in
HTML.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14155">PR#14155</a>)
</p>
<p>
</li>
<li><code>lchoose(a, k)</code> no longer wrongly gives <code>NaN</code> for
negative <code>a</code>.
</p>
<p>
</li>
<li><code>ks.test()</code> could give a p-value that was off by one
observation due to rounding
error.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14145">PR#14145</a>)
</p>
<p>
</li>
<li><code>readBin()</code>/<code>readChar()</code> when reading millions of
character strings in a single call used excessive amounts of
memory (which also slowed them down).
</p>
<p>
</li>
<li><CODE>R CMD SHLIB</CODE> could fail if used with paths that
were not alphanumeric, e.g. contained <code>'+'</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14168">PR#14168</a>)
</p>
<p>
</li>
<li><code>sprintf()</code> was not re-entrant, which potentially
caused problems if an <code>as.character()</code> method called it.
</p>
<p>
</li>
<li>The <code>quartz()</code> device did not restore the clipping
region when filling the background for a new page.  This could be
observed in multi-page bitmap output as stale outer regions of
the plot.
</p>
<p>
</li>
<li><code>p.adjust(*, method, n)</code> now works correctly for the
rare case <code>n &gt; length(p)</code>, also when method differs from
<code>"bonferroni"</code> or <code>"none"</code>, thanks to a patch from
Gordon Smyth.
</p>
<p>
</li>
<li><code>tools::showNonASCII()</code> failed to detect non-ASCII characters
if <code>iconv()</code> (incorrectly) converted them to different ASCII
characters.  (Seen on Windows only.)
</p>
<p>
</li>
<li><code>tcrossprod()</code> wrongly failed in some cases when one of the
arguments was a vector and the other a matrix.
</p>
<p>
</li>
<li><code>[cr]bind(..., deparse.level=2)</code> was not always giving
names when documented to do so.  (Discovered whilst investigating
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14189">PR#14189</a>.)
</p>
<p>
</li>
<li><code>match(incomparables=&lt;non-NULL&gt;)</code> could in rare cases
infinite-loop.
</p>
<p>
</li>
<li><code>poisson.test()</code> needed to pass <code>'conf.level'</code> to
<code>binom.test()</code>
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14195">PR#14195</a>)
</p>
<p>
</li>
<li>The <code>"nls"</code> method for <code>df.residual()</code> gave
incorrect results for models fitted with <code>na.action =
       na.exclude</code>.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14194">PR#14194</a>)
</p>
<p>
</li>
<li>A change to <code>options(scipen=)</code> was only implemented
when printing next occurred, even though it should have affected
intervening calls to <code>axis()</code>, <code>contour()</code> and
<code>filledcontour()</code>.
</p>
<p>
</li>
<li><code>prettyNum(drop0trailing=TRUE)</code> did not handle signs of
imaginary parts of complex numbers correctly (and this was used
by <code>str()</code>: <a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14201">PR#14201</a>).
</p>
<p>
</li>
<li><code>system.time()</code> had the <code>sys.child</code> component
wrong (copied <code>user.child</code> instead) on systems with
<code>HAVE_GETRUSAGE</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14210">PR#14210</a>)
</p>
<p>
</li>
<li>Changing both line texture and line cap (end) resulted in the
latter to be ommitted form the PDF code.  In addition, line cap
(end) and join are now set explicitly in PDF output to ensure
correct defaults.
</p>
<p>
</li>
<li>The suppression of auto-rotation in <code>bitmap()</code> and
<code>dev2bitmap()</code> with the <code>'pdfwrite'</code> device was not
working correctly.
</p>
<p>
</li>
<li><code>plot(ecdf(), log="x")</code> no longer gives an incorrect
warning.
</p>
<p>
</li>
<li><code>read.fwf()</code> works again when <code>'file'</code> is a connection.
</p>
<p>
</li>
<li>Startup files will now be found if their paths exceed 255
bytes.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14228">PR#14228</a>)
</p>
<p>
</li>
<li><code>contrasts&lt;-</code> (in the <code>'stats'</code> package) no longer has an
undeclared dependence on <code>'methods'</code> (introduced in 2.10.0).
</ul>

</p>

</p>


<h3>CHANGES IN R VERSION 2.10.1</h3>

<p>


<h4>NEW FEATURES</h4>

<p>

<ul>
<li> The PCRE library has been updated to version 8.00.
</p>
<p>
</li>
<li><CODE>R CMD INSTALL</CODE> has new options <span class="option">--no-R</span>,
<span class="option">--no-libs</span>, <span class="option">--no-data</span>, <span class="option">--no-help</span>,
<span class="option">--no-demo</span>, <span class="option">--no-exec</span>, and <span class="option">--no-inst</span> to
suppress installation of the specified part of the package.
These are intended for special purposes (e.g. building a database
of help pages without fully installing all packages).
</p>
<p>
</li>
<li>The documented line-length limit of 4095 bytes when reading
from the console now also applies also to <code>parse(file="")</code>
(which previously had a limit of around 1024 bytes).
</p>
<p>
</li>
<li>A Bioconductor mirror can be set for use by
<code>setRepositories()</code> via the option <code>"BioC_mirror"</code>,
e.g. the European mirror can be selected by
<code>options(BioC_mirror="http://bioconductor.statistik.tu-dortmund.de")</code>.
</p>
<p>
</li>
<li>Double-clicking in a <code>tk_select.list()</code> list box now
selects the item and closes the list box (as happens on the
Windows <code>select.list()</code> widget).
</ul>

</p>



<h4>INSTALLATION</h4>

<p>

<ul>
<li> <CODE>configure</CODE> will be able to find a usable
<code>libtiff</code> in some rare circumstances where it did not
previously (where <code>libtiff</code> needed to be linked explicitly against
<code>-ljpeg</code>).
</p>
<p>
</li>
<li>Making <code>refman.pdf</code> works around a problem with the indexing
with <code>hyperref 6.79d</code> and later.
</ul>

</p>



<h4>DEPRECATED &amp; DEFUNCT</h4>

<p>

<ul>
<li> The <code>'extended'</code> argument is deprecated in
<code>strsplit()</code>, <code>grep()</code>, <code>grepl()</code>, <code>sub()</code>,
<code>gsub()</code>, <code>regexpr()</code> and <code>gregexpr()</code> (not just
the value <code>extended = FALSE</code>) and will be removed in <font face="Courier New,Courier" color="#666666"><b>R</b></font>
2.11.0.
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

<ul>
<li> <code>trigamma(x)</code> and other <code>psigamma(x, n)</code> calls are
now accurate for very large <code>abs(x)</code>.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14020">PR#14020</a>)
</p>
<p>
</li>
<li><code>[g]sub(perl=FALSE, fixed=FALSE)</code> could use excessive
stack space when used with a very long vector containing some
non-ASCII strings.
</p>
<p>
</li>
<li>The default method of <code>weighted.mean(na.rm = TRUE)</code> did
not omit weights for <code>NA</code> observations in 2.10.0.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14032">PR#14032</a>)
</p>
<p>
</li>
<li><code>[g]regexpr(pattern, fixed = TRUE)</code> returned match
positions in bytes (not characters) in an MBCS locale if
<code>'pattern'</code> was a single byte.
</p>
<p>
<code>[g]sub(fixed = TRUE)</code> with a single-byte pattern could
conceivably have matched part of a multibyte character in a
non-UTF-8 MBCS.
</p>
<p>
</li>
<li><code>findLineNum()</code> and <code>setBreakpoint()</code> would
sometimes fail if the specified file was not in the current
directory.
</p>
<p>
</li>
<li>Package <code>tcltk</code>'s <code>demo(tkdensity)</code> was broken in
2.9.0 when <code>demo()</code> was changed to set <code>par(ask = TRUE)</code>.
</p>
<p>
</li>
<li><code>gsub()</code> with backrefs could fail on extremely long strings
(hundreds of thousands of characters) due to integer overflow
in a length calculation.
</p>
<p>
</li>
<li><code>abline(*, untf=TRUE)</code> now uses a better x-grid in
log-scale, e.g., for <code>plot(c(1,300), c(1,300), log="xy");
	 abline(4,1, untf=TRUE)</code>.
</p>
<p>
</li>
<li><code>detach()</code>/<code>unloadNamespace()</code> arrange to flush
the package's lazyload cache of <font face="Courier New,Courier" color="#666666"><b>R</b></font> objects once the
package/namespace is no longer needed.
</p>
<p>
</li>
<li>There have been small fixes to the rendering of help,
e.g. <code>\command</code> is now rendered verbatim (so e.g. <code>--</code>
is not interpreted,
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14045">PR#14045</a>).
</p>
<p>
Also, there are many small changes to help files where the new
converters were not rendering them in the same way as before.
</p>
<p>
</li>
<li><code>available.packages()</code> would fail when run on a
repository with no packages meeting the filtering conditions.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14042">PR#14042</a>)
</p>
<p>
</li>
<li><code>rep(x, times, each = 2)</code> gave invalid results when the
<code>'times'</code> argument was a vector longer than <code>'x'</code>.
Reported by Bill Dunlap.
</p>
<p>
</li>
<li>An error when <code>unloadNamespace()</code> attempted to run the
<code>.onUnload()</code> function gave an error in the reporting
function and so was not reported properly.
</p>
<p>
</li>
<li>Text help rendering did not handle very long input lines
properly.
</p>
<p>
</li>
<li><code>promptMethods()</code> generated signature documentation
improperly.
</p>
<p>
</li>
<li><code>pgamma(x, a, lower.tail=FALSE)</code> and
<code>qgamma(...)</code> are now considerably more accurate in some
regions for very small <code>'a'</code>.  <code>qgamma()</code> now correctly
returns <code>0</code> instead of <code>NaN</code> in similar extreme cases,
and <code>qgamma()</code> no longer warns in the case of small
<code>'a'</code>, see (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=12324">PR#12324</a>).
</p>
<p>
</li>
<li><code>unname()</code> now also removes names from a zero length vector.
</p>
<p>
</li>
<li>Printing results from <code>ls.str()</code> no longer evaluates
unevaluated calls.
</p>
<p>
</li>
<li><code>complete.cases()</code> failed on a 0-column data frame
argument.  (Underlies
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14066">PR#14066</a>.)
</p>
<p>
It could return nonsensical results if no input determined the
number of cases (seen in the no-segfault tests).
</p>
<p>
</li>
<li>An error in <code>nls()</code> with a long formula could cause a
segfault.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14059">PR#14059</a>)
</p>
<p>
</li>
<li><code>qchisq(p, df, ncp, lower.tail = FALSE)</code> with
<code>ncp &gt;= 80</code> was inaccurate for small <code>p</code> (as the help page
said): it is now less inaccurate.  (In part,
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13999">PR#13999</a>.)
</p>
<p>
For <code>ncp</code> less than but close to 80, <code>pchisq()</code> and
<code>qchisq()</code> are more accurate for probablilities very close
to 1 (a series expansion was truncated slightly too early).
</p>
<p>
<code>pchisq(x, df, ncp)</code> can no longer return values just larger
than one for large values of <code>ncp</code>.
</p>
<p>
</li>
<li><code>intToUtf8()</code> could fail when asked to produce 10Mb or more
strings, something it was never intended to do: unfortunately
Windows crashed <font face="Courier New,Courier" color="#666666"><b>R</b></font> (other OSes reported a lack of resources).
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14068">PR#14068</a>)
</p>
<p>
</li>
<li><code>chisq.test()</code> could fail when given argument
<code>'x'</code> or <code>'y'</code> which deparsed to more than one line.
(Reported by Laurent Gauthier.)
</p>
<p>
</li>
<li>S4 methods are uncached whenever the name space containing
them is unloaded (by <code>unloadNamespace()</code> as well as by
<code>detach(unload = TRUE))</code>.
</p>
<p>
</li>
<li>The internal record-keeping by
<code>dyn.load</code>/<code>dyn.unload</code> was incomplete, which could
crash <font face="Courier New,Courier" color="#666666"><b>R</b></font> if a DLL that registered <code>.External</code> routines had
earlier been unloaded.
</p>
<p>
</li>
<li><code>bessel[JY](x, nu)</code> with <code>nu</code> a negative integer (a
singular case) is now correct, analogously to <code>besselI()</code>,
see <a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13556">PR#13556</a>.
</p>
<p>
</li>
<li><code>tools::file_path_as_absolute()</code> doubled the file
separator when applied to a file such as <code>"/vmunix"</code> or (on
Windows) <code>"d:/afile"</code> in a directory for which
<code>getwd()</code> would return a path with a trailing separator
(largely cosmetic, as reasonable file systems handle such a path
correctly).  (Perhaps what was meant by
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14078">PR#14078</a>.)
</p>
<p>
</li>
<li><code>unsplit(drop = TRUE)</code> applied to a data frame failed
to pass <code>'drop'</code> to the computation of row names.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14084">PR#14084</a>)
</p>
<p>
</li>
<li>The <code>"difftime"</code> method of <code>mean()</code> ignored its
<code>'na.rm'</code> argument.
</p>
<p>
</li>
<li><code>tcltk::tk_select.list()</code> is now more likely to remove the
widget immediately after selection is complete.
</p>
<p>
</li>
<li>Adding/subtracting a <code>"difftime"</code> object to/from a
<code>"POSIXt"</code> or <code>"Date"</code> object works again (it was
broken by the addition of <code>Ops.difftime</code>).
</p>
<p>
</li>
<li>Conversion to latex of an <code>Rd</code> file with no aliases failed.
</p>
<p>
</li>
<li><code>wilcox.test(*, conf.int=TRUE)</code> has achieved.level
corrected and, for <code>exact=FALSE</code>, now gives an
<code>'estimate'</code> which does not depend on the alternative used.
</p>
<p>
</li>
<li><code>help.search()</code> failed when the package argument was
specified.  (<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=14113">PR#14113</a>)
</p>
<p>
</li>
<li><code>switch(EXPR = "A")</code> now returns <code>NULL</code>, as does
<code>switch(1)</code> (which used to signal an error).
</ul>

</p>

</p>


<h3>CHANGES IN R VERSION 2.10.0</h3>

<p>


<h4>SIGNIFICANT USER-VISIBLE CHANGES</h4>

<p>

<ul>
<li> Package help is now converted from <code>Rd</code> by the <font face="Courier New,Courier" color="#666666"><b>R</b></font>-based
converters that were first introduced in 2.9.0.  This means
</p>
<p>

<ul>
<li> Packages that were installed by R-devel after 2009-08-09
should not be used with earlier versions of <font face="Courier New,Courier" color="#666666"><b>R</b></font>, and most
aspects of package help (including the runnable examples)
will be missing if they are so used.
</p>
<p>
</li>
<li>Text, HTML and latex help and examples for packages
installed under the new system are converted on-demand from
stored parsed Rd files.  (Conversions stored in packages
installed under <font face="Courier New,Courier" color="#666666"><b>R</b></font> &lt; 2.10.0 are used if no parsed Rd files
are found.  It is recommended that such packages be
re-installed.)
</ul>

</p>
<p>
</li>
<li>HTML help is now generated dynamically using an HTTP server
running in the <font face="Courier New,Courier" color="#666666"><b>R</b></font> process and listening on the loopback
interface.
</p>
<p>

<ul>
<li> Those worried about security implications of such
a server can disable it by setting the environment variable
<code>R_DISABLE_HTTPD</code> to a non-empty value.  This disables
<code>help.start()</code> and HTML help (so text help is shown
instead).
</p>
<p>
</li>
<li>The Java/Javascript search engine has been replaced by an
HTML interface to <code>help.search()</code>.  <code>help.start()</code> no
longer has an argument <code>'searchEngine'</code> as it is no longer
needed.
</p>
<p>
</li>
<li>The HTML help can now locate cross-references of the form
<code>\link[pkg]{foo}</code> and <code>\link[pkg:foo]{bar}</code>
where <code>'foo'</code> is an alias in the package, rather than the
documented (basename of a) filename (since the documentation
has been much ignored).
</ul>

</ul>

</p>



<h4>NEW FEATURES</h4>

<p>

</p>
<p>
<ul>
<li> <code>polygon()</code>, <code>pdf()</code> and <code>postscript()</code> now
have a parameter <code>'fillOddEven'</code> (default <code>FALSE</code>),
which controls the mode used for polygon fills of
self-intersecting shapes.
</p>
<p>
</li>
<li>New <code>debugonce()</code> function; further,
<code>getOption("deparse.max.lines")</code> is now observed when
debugging, from a code suggestion by John Brzustowski.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13647">PR#13647</a>/8)
</p>
<p>
</li>
<li><code>plot()</code> methods for <code>"stepfun"</code> and hence
<code>"ecdf"</code> no longer plot points by default for <code>n &gt;= 1000</code>.
</p>
<p>
</li>
<li><code>[g]sub(*, perl=TRUE)</code> now also supports <code>'\E'</code>
in order to <STRONG>end</STRONG> <code>\U</code> and <code>\L</code> case changes,
thanks to a patch from Bill Dunlap.
</p>
<p>
</li>
<li><code>factor()</code>, <code>`levels&lt;-`()</code>, etc, now ensure that
the resulting factor levels are unique (as was always the implied
intention).  Factors with duplicated levels are still
constructible by low-level means, but are now declared illegal.
</p>
<p>
</li>
<li>New <code>print()</code> (S3) method for class <code>"function"</code>,
also used for auto-printing.  Further, <code>.Primitive</code>
functions now print and auto-print identically.  The new method
is based on code suggestions by Romain François.
</p>
<p>
</li>
<li>The <code>print()</code> and <code>toLatex()</code> methods for class
<code>"sessionInfo"</code> now show the locale in a nicer format and
have arguments to suppress locale information.
</p>
<p>
</li>
<li>In addition to previously only <code>round()</code>, there are
other <code>'Math'</code> group (S3) methods for <code>'difftime'</code>,
such as <code>floor()</code>, <code>signif()</code>, <code>abs()</code>, etc.
</p>
<p>
</li>
<li>For completeness, <code>old.packages()</code> and
<code>available.packages()</code> allow <code>'type'</code> to be specified
(you could always specify <code>'available'</code> or
<code>'contriburl'</code>).
</p>
<p>
</li>
<li><code>available.packages()</code> by default only returns
information on the latest versions of packages whose version
requirements are satisified by the currently running <font face="Courier New,Courier" color="#666666"><b>R</b></font>.
</p>
<p>
</li>
<li><code>tools::write_PACKAGES()</code> has a new argument
<code>'latestOnly'</code>, which defaults to <code>TRUE</code> when only the
latest versions in the repository will be listed in the index.
</p>
<p>
</li>
<li><code>getOption()</code> has a new argument <code>'default'</code> that
is returned if the specified option is not set.  This simplifies
querying a value and checking whether it is <code>NULL</code> or not.
</p>
<p>
</li>
<li><code>parse()</code> now warns if the requested encoding is not supported.
</p>
<p>
</li>
<li>The <code>"table"</code> method of <code>as.data.frame()</code> gains a
<code>'stringsAsFactors'</code> argument to allow the classifying
factors to be returned as character vectors rather than the
default factor type.
</p>
<p>
</li>
<li>If <code>model.frame.default()</code> encounters a character
variable where <code>'xlev'</code> indicates a factor, it now converts
the variable to a factor (with a warning).
</p>
<p>
</li>
<li><code>curve()</code> now returns a list containing the points that
were drawn.
</p>
<p>
</li>
<li><code>spineplot()</code> now accepts <code>axes = FALSE</code>, for
consistency with other functions called by <code>plot.factor()</code>.
</p>
<p>
</li>
<li>The Kendall and Spearman methods of <code>cor.test()</code> can
optionally use continuity correction when not computing exact
p-values.  (The Kendall case is the wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13691">PR#13691</a>.)
</p>
<p>
</li>
<li><font face="Courier New,Courier" color="#666666"><b>R</b></font> now keeps track of line numbers during execution for code
sourced with <code>options(keep.source = TRUE)</code>.  The source
reference is displayed by debugging functions such as
<code>traceback()</code>, <code>browser()</code>, <code>recover()</code>, and
<code>dump.frames()</code>, and is stored as an attribute on each
element returned by <code>sys.calls()</code>.
</p>
<p>
</li>
<li>More functions now have an implicit (S4) generic definition.
</p>
<p>
</li>
<li><code>quantile.default()</code> now disallows factors (wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13631">PR#13631</a>) and its help
documents what numeric-like properties its input need to have to
work correctly.
</p>
<p>
</li>
<li><code>weighted.mean()</code> is now generic and has <code>"Date"</code>,
<code>"POSIXct"</code> and <code>"POSIXlt"</code> methods.
</p>
<p>
</li>
<li>Naming subscripts (e.g. <code>x[i=1, j=2]</code>) in
<code>data.frame</code> methods for <code>[</code> and <code>[[</code> now gives a
warning.  (Names are ignored in the default method, but could
have odd semantics for other methods, and do for the data.frame
ones.)
</p>
<p>
</li>
<li><code>as.data.frame()</code> has an <code>"aovproj"</code> method.
(Wish of <a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13505">PR#13505</a>)
</p>
<p>
</li>
<li><code>as.character(x)</code> for numeric <code>x</code> no longer
produces strings such as <code>"0.30"</code>, i.e., with trailing
zeros.  This change also renders levels construction in
<code>factor()</code> more consistent.
</p>
<p>
</li>
<li><code>codocClasses()</code>, which checks consistency of the
documentation of S4 class slots, now does so in considerably more
cases.  The documentation of inherited slots (from superclasses)
is now optional.  This affects <CODE>R CMD check &lt;pkg&gt;</CODE> when
the package defines S4 classes.
</p>
<p>
</li>
<li><code>codoc()</code> now also checks S4 methods for code/documentation
mismatches.
</p>
<p>
</li>
<li><code>for()</code>, <code>while()</code>, and <code>repeat()</code> loops now
always return NULL as their (invisible) value.  This change was
needed to address a reference counting bug without creating
performance penalties for some common use cases.
</p>
<p>
</li>
<li>The <code>print()</code> method for <code>ls.str()</code> results now
obeys an optional <code>'digits'</code> argument.
</p>
<p>
</li>
<li>The <code>'method'</code> argument of <code>glm()</code> now allows
user-contributed methods.
</p>
<p>
</li>
<li>More general <code>reorder.default()</code> replaces functionality of
<code>reorder.factor()</code> and <code>reorder.character()</code>.
</p>
<p>
</li>
<li>The function <code>aspell()</code> has been added to provide an
interface to the <CODE>Aspell</CODE> spell-checker.
</p>
<p>
</li>
<li>Filters <code>RdTextFilter()</code> and <code>SweaveTeXFilter()</code>
have been added to the tools package to provide support for
<code>aspell()</code> or other spell checkers.
</p>
<p>
</li>
<li><code>xtabs()</code> with the new option <code>'sparse = TRUE'</code>
now returns a sparse Matrix, using package <code>'Matrix'</code>.
</p>
<p>
</li>
<li><code>contr.sum()</code> etc gain an argument <code>'sparse'</code>
which allows sparse matrices to be returned.
</p>
<p>
<code>contrasts()</code> also gains a <code>'sparse'</code> argument which it
passes to the actual contrast function if that has a formal
argument <code>'sparse'</code>.
</p>
<p>
<code>'contrasts(f, .) &lt;- val'</code> now also works when <code>'val'</code>
is a sparse Matrix.  It is planned that <code>model.matrix()</code>
will work with such factors <code>'f'</code> in the future.
</p>
<p>
</li>
<li><code>readNEWS()</code> will recognize a UTF-8 byte-order mark
(BOM) in the <code>NEWS</code> file.  However, it is safer to use only
ASCII code there because not all editors recognize BOMs.
</p>
<p>
</li>
<li>New utility function <code>inheritedSlotNames()</code> for S4
class programming.
</p>
<p>
</li>
<li><code>tabulate()</code> now allows NAs to pass through (and be ignored).
</p>
<p>
</li>
<li>If <code>debug()</code> is called on an S3 generic function then
all methods are debugged as well.
</p>
<p>
</li>
<li>Outlier symbols drawn by <code>boxplot()</code> now obey the
<code>'outlwd'</code> argument.  Reported by Jurgen Kluge.
</p>
<p>
</li>
<li><code>svd(x)</code> and <code>eigen(x)</code> now behave analogously to
<code>qr(x)</code> in accepting logical matrices <code>x</code>.
</p>
<p>
</li>
<li>File <code>NEWS</code> is now in UTF-8, and has a BOM (often
invisible) on the first line, and <CODE>Emacs</CODE> local variables
set for UTF-8 at the end.  <code>RShowDoc("NEWS")</code> should display
this correctly, given suitable fonts.
</p>
<p>
</li>
<li><code>terms.formula(simplify = TRUE)</code> now does not deparse
the LHS and so preserves non-standard responses such as <code>`a:
       b`</code> (requested by Sundar Dorai-Raj).
</p>
<p>
</li>
<li>New function <code>news()</code> for building and querying <font face="Courier New,Courier" color="#666666"><b>R</b></font> or
package news information.
</p>
<p>
</li>
<li><code>z^n</code> for integer <code>n</code> and complex <code>z</code> is more
accurate now if <code>|n| &lt;= 65536</code>.
</p>
<p>
</li>
<li><code>factor(NULL)</code> now returns the same as
<code>factor(character(0))</code> instead of an error, and
<code>table(NULL)</code> consequently does analogously.
</p>
<p>
</li>
<li><code>as.data.frame.vector()</code> (and its copies) is slightly faster
by avoiding a copy if there are no names (following a
suggestion of Tim Hesterberg).
</p>
<p>
</li>
<li><code>writeLines()</code>, <code>writeBin()</code> and
<code>writeChar()</code> have a new argument <code>'useBytes'</code>.  If
false, character strings with marked encodings are translated to
the current locale (as before) but if true they are written
byte-by-byte.
</p>
<p>
</li>
<li><code>iconv()</code> has a new argument <code>'mark'</code> which can be
used (by experts) to suppress the declaration of encodings.
</p>
<p>
</li>
<li><code>DESCRIPTION</code> <code>'LinkingTo'</code> specs are now
recognized as installation dependencies, and included in package
management computations.
</p>
<p>
</li>
<li>Standardized <code>DESCRIPTION</code> <code>'License'</code> specs are
now available for package management computations.
</p>
<p>
</li>
<li><code>"\uxxxx"</code> and <code>"\Uxxxxxxxx"</code> escapes can now be
parsed to a UTF-8 encoded string even in non-UTF-8 locales (this
has been implemented on Windows since <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.7.0).  The semantics
have been changed slightly: a string containing such escapes is
always stored in UTF-8 (and hence is suitable for portably
including Unicode text in packages).
</p>
<p>
</li>
<li>New <code>as.raw()</code> method for <code>"tclObj"</code> objects (wish
of <a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13758">PR#13758</a>).
</p>
<p>
</li>
<li><code>Rd.sty</code> now makes a better job of setting email addresses,
including using a monospaced font.
</p>
<p>
</li>
<li><code>textConnection()</code> gains an <code>'encoding'</code> argument
to determine how input strings with marked encodings will be
handled.
</p>
<p>
</li>
<li><CODE>R CMD Rd2pdf</CODE> is available as a shortcut for
<CODE>R CMD Rd2dvi --pdf</CODE>.
</p>
<p>
</li>
<li><CODE>R CMD check</CODE> now checks links where a package is
specified (<code>\link[pkg]{file}</code> or
<code>\link[pkg:file]{topic}</code>), if the package is available.
It notes if the package is not available, as in many cases this
is an error in the link.
</p>
<p>
</li>
<li><code>identical()</code> gains three logical arguments, which
allow for even more differentiation, notably <code>'-0'</code> and
<code>'0'</code>.
</p>
<p>
</li>
<li><code>legend()</code> now can specify the <code>'border'</code> color of
filled boxes, thanks to a patch from Frederic Schutz.
</p>
<p>
</li>
<li>Indexing with a vector index to <code>[[ ]]</code> has now been
extended to all recursive types.
</p>
<p>
</li>
<li>Pairlists may now be assigned as elements of lists.  (Lists
could always be created with pairlist elements, but <code>[[&lt;-</code>
didn't support assigning them.)
</p>
<p>
</li>
<li>The parser now supports C-preprocessor-like <code>#line</code>
directives, so error messages and source references may refer to
the original file rather than an intermediate one.
</p>
<p>
</li>
<li>New functions <code>findLineNum()</code> and
<code>setBreakpoint()</code> work with the source references to find
the location of source lines and set breakpoints (using
<code>trace()</code>) at those lines.
</p>
<p>
</li>
<li>Namespace importing is more careful about warning on masked
generics, thanks to a patch by Yohan Chalabi.
</p>
<p>
</li>
<li><code>detach()</code> now has an argument <code>'character.only'</code>
with the same meaning as for <code>library()</code> or
<code>require()</code>.
</p>
<p>
</li>
<li><code>available.packages()</code> gains a <code>'filters'</code>
argument for specifying the filtering operations performed on the
packages found in the repositories.  A new built-in
<code>'license/FOSS'</code> filter only retains packages for which
installation can proceed solely based on packages which can be
verified as Free or Open Source Software (FOSS) employing the
available license specifications.
</p>
<p>
</li>
<li>In registering an S3 class by a call to
<code>setOldClass()</code>, the data part (e.g., the object type)
required for the class can be included as one of the superclasses
in the Classes argument.
</p>
<p>
</li>
<li>The argument <code>'f'</code> to <code>showMethods()</code> can be an
expression evaluating to a generic function, allowing methods to
be shown for non-exported generics and other nonstandard cases.
</p>
<p>
</li>
<li><code>sprintf()</code> now supports <code>'%o'</code> for octal
conversions.
</p>
<p>
</li>
<li>New function <code>Sys.readlink()</code> for information about symbolic
links, including if a file is a symbolic link.
</p>
<p>
</li>
<li>Package <code>'tools'</code> has new functions
<code>checkRdaFiles()</code> and <code>resaveRdaFiles()</code> to report on
the format of <code>.rda</code>/<code>.RData</code> data files, and to
re-save them in a different compressed format, including choosing
the most compact format available.
</p>
<p>
A new <CODE>INSTALL</CODE> option, <span class="option">--resave-data</span>, makes use
of this.
</p>
<p>
</li>
<li>File <code>~/.R/config</code> is used in preference to
<code>~/.Rconfig</code>, and these are now documented in &lsquo;R
Installation and Administration'&rsquo;.
</p>
<p>
</li>
<li>Logic operations with complex numbers now work, as they were always
documented to, and as in S.
</p>
<p>
</li>
<li><code>arrows()</code> and <code>segments()</code> allow one of <code>x1</code>
or <code>y1</code> to be omitted to simplify the specification of
vertical or horizontal lines (suggestion of Tim Hesterberg).
</p>
<p>
</li>
<li><code>approxfun()</code> is faster by avoiding repeated <code>NA</code>
checks (diagnosis and patch by Karline Soetaert &amp; Thomas
Petzoldt).
</p>
<p>
</li>
<li>There are the beginnings of a Nynorsk translation by Karl Ove
Hufthammer.
</p>
<p>
</li>
<li><code>stripchart()</code> allows <code>par</code> <code>'bg'</code> to be
passed in for the background colour for <code>pch = 21</code> (wish of
<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13984">PR#13984</a>).
</p>
<p>
</li>
<li>New generic function <code>.DollarNames()</code> to enable class authors
to customize completion after the <code>$</code> extractor.
</p>
<p>
</li>
<li><code>load()</code>, <code>save()</code>, <code>dput()</code> and
<code>dump()</code> now open a not-yet-open connection in the
appropriate mode (as other functions using connections directly
already did).
</ul>

</p>



<h4>REGULAR EXPRESSIONS</h4>

<p>

<ul>
<li> A different regular expression engine is used for basic and
extended regexps and is also for approximate matching.  This is
based on the TRE library of Ville Laurikari, a modifed copy of
which is included in the <font face="Courier New,Courier" color="#666666"><b>R</b></font> sources.
</p>
<p>
This is often faster, especially in a MBCS locale.
</p>
<p>
Some known differences are that it is less tolerant of invalid
inputs in MBCS locales, and in its interpretation of undefined
(extended) regexps such as <code>"^*"</code>.  Also, the interpretation of
ranges such as <code>[W-z]</code> in caseless matching is no longer to map
the range to lower case.
</p>
<p>
This engine may in future be used in &lsquo;literal&rsquo; mode for
<code>fixed = TRUE</code>, and there is a compile-time option in
<code>src/main/grep.c</code> to do so.
</p>
<p>
</li>
<li>The use of repeated boundary regexps in <code>gsub()</code> and
<code>gregexpr()</code> as warned about in the help page does not work
in this engine (it did in the previous one since 2005).
</p>
<p>
</li>
<li>Extended (and basic) regexps now support same set of options
as for <code>fixed = TRUE</code> and <code>perl = TRUE</code>, including
<code>'useBytes'</code> and support for UTF-8-encoded strings in
non-UTF-8 locales.
</p>
<p>
</li>
<li><code>agrep()</code> now has full support for MBCS locales with a modest
speed penalty.  This enables <code>help.search()</code> to use approximate
matching character-wise rather than byte-wise.
</p>
<p>
</li>
<li><code>[g]sub</code> use a single-pass algorithm instead of
matching twice and so is usually faster.
</p>
<p>
</li>
<li>The <code>perl = TRUE</code> versions now work correctly in a
non-UTF-8 MBCS locale, by translating the inputs to UTF-8.
</p>
<p>
</li>
<li><code>useBytes = TRUE</code> now inhibits the translation of inputs with
marked encodings.
</p>
<p>
</li>
<li><code>strsplit()</code> gains a <code>'useBytes'</code> argument.
</p>
<p>
</li>
<li>The algorithm used by <code>strsplit()</code> has been reordered
to batch by elements of <code>'split'</code>: this can be much faster for
<code>fixed = FALSE</code> (as multiple compilation of regexps is avoided).
</p>
<p>
</li>
<li>The help pages, including <code>?regexp</code>, have been updated
and should be consulted for details of the new implementations.
</ul>

</p>



<h4>HELP &amp; Rd FILE CHANGES</h4>

<p>

<ul>
<li> A new dynamic HTML help system is used by default, and may be
controlled using <code>tools::startDynamicHelp()</code>.  With this enabled,
HTML help pages will be generated on request, resolving links
by searching through the current <code>.libPaths()</code>.  The user
may set options(<code>"help.ports"</code>) to control which IP port is used
by the server.
</p>
<p>
</li>
<li><code>help.start()</code> no longer sets <code>options(htmlhelp =
       TRUE)</code> (it used to on Unix but not on Windows).  Nor does it on
Unix reset the <code>"browser"</code> option if given an argument of
that name.
</p>
<p>
Arguments <code>'update'</code> and <code>'remote'</code> are now available
on all platforms: the default is <code>update = FALSE</code> since the
http server will update the package index at first use.
</p>
<p>
</li>
<li><code>help()</code> has a new argument <code>'help_type'</code> (with
default set by the option of that name) to supersede
<code>'offline'</code>, <code>'htmlhelp'</code> and <code>'chmhelp'</code>
(although for now they still work if <code>'help_type'</code> is
unset).  There is a new type, <code>"PDF"</code> to allow offline PDF
(rather than PostScript).
</p>
<p>
A function <code>offline_help_helper()</code> will be used if this exists
in the workspace or further down the search path, otherwise
the function of that name in the <code>'utils'</code> name space is used.
</p>
<p>
</li>
<li>Plain text help is now used as the fallback for HTML help (as
it always was for Compiled HTML help on Windows).
</p>
<p>
</li>
<li>It is possible to ask for static HTML pages to be prebuilt
via the configure option <span class="option">--enable-prebuilt-html</span>.  This
may be useful for those who wish to make HTML help available
outside R, e.g. on a local web site.
</p>
<p>
</li>
<li>An experimental tag <code>\Sexpr</code> has been added to Rd
files, to evaluate expressions at build, install, or render time.
Currently install time and render time evaluation are supported.
</p>
<p>
</li>
<li>Tags <code>\if</code>, <code>\ifelse</code> and <code>\out</code> have been
added to allow format-specific (or more general, using
<code>\Sexpr</code>) conditional text in man pages.
</p>
<p>
</li>
<li>The <code>parse_Rd()</code> parser has been made more tolerant of coding
errors in Rd files:  now all syntax errors are reported as
warnings, and an attempt is made to continue parsing.
</p>
<p>
</li>
<li><code>parse_Rd()</code> now has an argument <code>'fragment'</code>
(default <code>FALSE</code>) to accept small fragments of Rd files (so
that <code>\Sexpr</code> can output Rd code which is then parsed).
</p>
<p>
</li>
<li><code>parse_Rd()</code> now always converts its input to UTF-8.
The <code>Rd2*</code> rendering functions have a new parameter,
<code>'outputEncoding'</code>, which controls how their output is
encoded.
</p>
<p>
</li>
<li><code>parse_Rd()</code> no longer includes the newline as part of
a <code>"%"</code>-style comment.
</p>
<p>
</li>
<li>There have been various bug fixes and code reorganization in
the Rd renderers <code>Rd2HTML</code>, <code>Rd2latex</code>, <code>Rd2txt</code>,
and <code>Rd2ex</code>.
</p>
<p>
All example files are now created with either ASCII or UTF-8
encoding, and the encoding is only marked in the file if there
is any non-UTF-8 code (previously it was marked if the help
file had non-ASCII contents, possibly in other sections).
</p>
<p>
</li>
<li><code>print.Rd()</code> now adds necessary escape characters so that
printing and re-parsing an Rd object should produce an
equivalent object.
</p>
<p>
</li>
<li><code>parse_Rd()</code> was incorrectly handling multiple backslashes in
<font face="Courier New,Courier" color="#666666"><b>R</b></font> code strings, converting 4n+3 backslashes to 2n+1 instead
of 2n+2.
</p>
<p>
</li>
<li><code>parse_Rd()</code> now recognizes the <code>\var</code> tag within
a quoted string in <font face="Courier New,Courier" color="#666666"><b>R</b></font>-like text.
</p>
<p>
</li>
<li><code>parse_Rd()</code> now treats the argument of
<code>\command</code> as LaTeX-like, rather than verbatim.
</ul>

</p>



<h4>COMPRESSION</h4>

<p>

<ul>
<li> New function <code>untar()</code> to list or unpack tar archives,
possibly compressed.  This uses either an external <code>'tar'</code>
command or an internal implementation.
</p>
<p>
</li>
<li>New function <code>tar()</code> to create (possibly compressed)
tar archives.
</p>
<p>
</li>
<li>New functions <code>memCompress()</code> and
<code>memDecompress()</code> for in-memory compression and
decompression.
</p>
<p>
</li>
<li><code>bzfile()</code> has a <code>'compress'</code> argument to select
the amount of effort put into compression when writing.
</p>
<p>
</li>
<li>New function <code>xzfile()</code> for use with
<CODE>xz</CODE>-compressed files.  (This can also read files
compressed by some versions of <CODE>'lzma'</CODE>.)
</p>
<p>
</li>
<li><code>gzfile()</code> looks at the file header and so can now also
read <CODE>bzip2</CODE>-ed files and <CODE>xz</CODE>-compressed files.
</p>
<p>
</li>
<li>There are the new options of <code>save(compress = "bzip2")</code>
and <code>"xz"</code> to use <CODE>bzip2</CODE> or <CODE>xz</CODE>
compression (which will be slower, but can give substantially
smaller files).  Argument <code>compression_level</code> gives finer
control over the space/time tradeoffs.
</p>
<p>
<code>load()</code> can read such saves (but only as from this version of <font face="Courier New,Courier" color="#666666"><b>R</b></font>).
</p>
<p>
</li>
<li><CODE>R CMD INSTALL</CODE>/<CODE>check</CODE> and
<code>tools::writePACKAGES</code> accept a wider range of compressed
tar archives.  Precisely how wide depends on the capabilities of
the host system's <CODE>'tar'</CODE> command: they almost always
include <CODE>.tar.bz2</CODE> archives, and with modern versions of
<CODE>'tar'</CODE> other forms of compression such as <CODE>lzma</CODE>
and <CODE>xz</CODE>, and arbitrary extensions.
</p>
<p>
</li>
<li><CODE>R CMD INSTALL</CODE> has a new option
<span class="option">--data-compress</span> to control the compression used when
lazy-loading data.  New possibilities are
<span class="option">--data-compress=bzip2</span> which will give ca 15% better
compression at the expense of slower installation times, and
<span class="option">--data-compress=xz</span>, often giving even better compression
on large datasets at the expense of much longer installation
times.  (The latter is used for the recommended packages: it is
particularly effective for <code>'survival'</code>.)
</p>
<p>
</li>
<li><code>file()</code> for open = <code>""</code>, <code>"r"</code> or
<code>"rt"</code> will automagically detect compressed files (from
<CODE>gzip</CODE>, <CODE>bzip2</CODE> or <CODE>xz</CODE>).  This means
that compressed files can be specified by file name (rather than
via a <code>gzfile()</code> connection) to <code>read.table()</code>,
<code>readlines()</code>, <code>scan()</code> and so on.
</p>
<p>
</li>
<li><code>data()</code> can handle compressed text files with extensions
<code>.{txt,tab,csv}.{gz,bz2,xz}</code> .
</ul>

</p>



<h4>DEPRECATED &amp; DEFUNCT</h4>

<p>

<ul>
<li> <code>png(type="cairo1")</code> is defunct: the value is no longer
recognized.
</p>
<p>
</li>
<li><code>tools::Rd_parse()</code> is defunct (as this version of <font face="Courier New,Courier" color="#666666"><b>R</b></font> uses only
Rd version 2).
</p>
<p>
</li>
<li>Use of <code>~/.Rconf</code> (which was deprecated in favour of
<code>~/.Rconfig</code> in 2004) has finally been removed.
</p>
<p>
</li>
<li>Bundles of packages are deprecated.  See &lsquo;Writing R
Extensions&rsquo; for the steps needed to unbundle a bundle.
</p>
<p>
</li>
<li><code>help()</code> arguments <code>'offline'</code>, <code>'htmlhelp'</code>
and <code>'chmhelp'</code> are deprecated in favour of
<code>'help_type'</code>.
</p>
<p>
</li>
<li><code>clearNames()</code> (in package <code>'stats'</code>) is
deprecated for <code>unname()</code>.
</p>
<p>
</li>
<li>Basic regular expressions (<code>extended = FALSE</code>) are
deprecated in <code>strsplit</code>, <code>grep</code> and friends.  There is
a precise POSIX standard for them, but it is not what recent RE
engines implement, and it seems that in almost all cases package
authors intended <code>fixed = TRUE</code> when using <code>extended =
       FALSE</code>.
</p>
<p>
</li>
<li><code>methods::trySilent()</code> is deprecated in favour of
<code>try(*, silent=TRUE)</code> or &ndash; more efficiently and flexibly &ndash;
something like <code>tryCatch(*, error = function(e) e)</code>.
</p>
<p>
</li>
<li><code>index.search()</code> is deprecated: there are no longer
directories of types other than <code>'help'</code>.
</ul>

</p>



<h4>INSTALLATION</h4>

<p>

<ul>
<li> cairo &gt;= 1.2 is now required (1.2.0 was released in July 2006)
for cairo-based graphics devices (which remain optional).
</p>
<p>
</li>
<li>A suitable <code>iconv()</code> is now required: support for
configure option <span class="option">--without-iconv</span> has been withdrawn (it
was deprecated in <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.5.0).
</p>
<p>
</li>
<li>Perl is no longer &lsquo;essential&rsquo;.  <font face="Courier New,Courier" color="#666666"><b>R</b></font> can be built
without it, but scripts <CODE>R CMD build</CODE>, <CODE>check</CODE>,
<CODE>Rprof</CODE> and <CODE>Sd2d</CODE> currently require it.
</p>
<p>
</li>
<li>A system <CODE>glob</CODE> function is now essential (a working
<code>Sys.glob()</code> has been assumed since <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.9.0 at least).
</p>
<p>
</li>
<li>C99 support for MBCS is now required, and configure option
<span class="option">--disable-mbcs</span> has been withdrawn.
</p>
<p>
</li>
<li>Having a version of <code>'tar'</code> capable of automagically
detecting compressed archives is useful for
<code>utils::untar()</code>, and so <code>'gtar'</code> (a common name for
GNU <code>tar</code>) is preferred to <code>'tar'</code>: set environment
variable <code>TAR</code> to specify a particular <code>'tar'</code> command.
</ul>

</p>



<h4>INTERNATIONALIZATION</h4>

<p>

<ul>
<li> There is some makefile support for adding/updating translations
in packages: see <code>po/README</code> and &lsquo;Writing R Extensions&rsquo;.
</p>
<p>
There is support for the use of <code>'dngettext'</code> for C-level
translations in packages: see &lsquo;Writing R Extensions&rsquo;.
</ul>

</p>



<h4>BUG FIXES</h4>

<p>

<ul>
<li> Assigning an extra 0-length column to a data frame by
<code>DF[, "foo"] &lt;- value</code> now works in most cases (by filling
with <code>NA</code>s) or fails.  (It used to give a corrupt data
frame.)
</p>
<p>
</li>
<li><code>validObject()</code> avoids an error during evaluation in the case
of various incorrect slot definitions.
</p>
<p>
</li>
<li><code>n:m</code> now returns a result of type <code>"integer"</code> in
a few more boundary cases.
</p>
<p>
</li>
<li>The <code>'zap.ind'</code> argument to <code>printCoefmat()</code> did
not usually work as other code attempted to ensure that non-zero
values had a non-zero representation.
</p>
<p>
</li>
<li><code>printCoefmat()</code> formatted groups of columns together,
not just the <code>cs.ind</code> group but also the <code>zap.ind</code>
group and a residual group.  It now formats all columns except
the <code>cs.ind</code> group separately (and zaps the <code>zap.ind</code>
group column-by-column).  The main effect will be see in the
output from <code>print.anova()</code>, as this grouped SS-like columns
in the <code>zap.ind</code> group.
</p>
<p>
</li>
<li><code>R_ReplDLLinit()</code> initializes the top-level jump so
that some embedded applications on Windows no longer crash on
error.
</p>
<p>
</li>
<li><code>identical()</code> failed to take the encoding of character
strings into account, so identical byte patterns are not
necessarily identical strings, and similarly Latin-1 and UTF-8
versions of the same string differ in byte pattern.
</p>
<p>
</li>
<li><code>methods(f)</code> used to warn unnecessarily for an S4
generic <code>'f'</code> which had been created based on an existing S3
generic.
</p>
<p>
</li>
<li>The check for consistent ordering of superclasses was not
ignoring all conditional relations (the symptom was usually
spurious warnings for classes extending <code>"array"</code>).
</p>
<p>
</li>
<li>Trying to assign into a raw vector with an index vector
containing <code>NA</code>s could cause a segfault.  Reported by Hervé
Pagès.
</p>
<p>
</li>
<li><CODE>Rscript</CODE> could segfault if (by user error) its
filename argument was missing.  Reported by Martin Morgan.
</p>
<p>
</li>
<li><code>getAnywhere()</code> (and functions that use it, including argument
completion in the console) did not handle special built-in
functions.  Reported by Romain Francois.
</p>
<p>
</li>
<li><code>order()</code> was missing a <code>PROTECT()</code> call and so
could segfault when called on character data under certain (rare)
circumstances involving marked non-native encodings.
</p>
<p>
</li>
<li><code>prettyNum(z, drop0trailing=TRUE)</code> did not work
correctly when <code>z</code> was a complex vector.  Consequently,
<code>str(z, ...)</code> also did not.
(<a href="https://bugs.R-project.org/bugzilla3/show_bug.cgi?id=13985">PR#13985</a>)
</p>
<p>
</li>
<li><CODE>'make distclean'</CODE> removed too many files in
<code>etc/</code> if builddir = srcdir.
</p>
<p>
</li>
<li><CODE>R CMD</CODE> replaced <code>TEXINPUTS</code> rather than
appending to it (as documented and intended).
</p>
<p>
</li>
<li><code>help.start()</code> no longer fails on unix when
<code>"browser"</code> is a function.
</p>
<p>
</li>
<li><code>pbeta(x, *, log.p = TRUE)</code> is sometimes more accurate,
e.g., for very small <code>x</code>.
</p>
<p>
</li>
<li>Unserializing a pre-2.8 workspace containing pure ASCII
character objects with a Latin-1 or UTF-8 encoding would corrupt
the <code>CHARSXP</code> cache.
</ul>

</p>

</p>


</body></html>
