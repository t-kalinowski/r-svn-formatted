#! @PERL@
#-*- perl -*-
#
# ${RHOME}/etc/build-html
# Usage:  build-html [pkg] [lib]
# Install all html help files for package pkg to library lib
# (defaults are `${RHOME}/src/library/base' and the default library,
# `${RHOME}/library', respectively). 

use File::Basename;
use Cwd;

$cwd=getcwd();
if($ENV{"RHOME"}){
    $RHOME=$ENV{"RHOME"};
}
else{
    chdir(dirname($0) . "/..");
    $RHOME=getcwd();
}
chdir($cwd);

require "$RHOME/etc/Rdconvlib.pl";
require "$RHOME/etc/buildlib.pl";

($pkg, $lib) = buildinit();

print " >>> Building HTML pages for package `$pkg'\n";

chdir "man" or die("There are no man pages in $pkg\n");

$dest = "$lib/$pkg/html";
system("mkdir -p $dest");
die("Cannot create $dest\n") unless (-d $dest);

opendir man, '.';
@mandir = readdir(man);

%htmlindex = read_htmlindex($lib);

foreach $manfile (@mandir) {
    if($manfile =~ /\.Rd$/){
	$manfilebase = basename($manfile, ".Rd");
	$destfile = "$dest/$manfilebase.html";
	print "  $manfilebase\n";
	open(htmlout,">$destfile");
	Rdconv($manfile, "html", "");
	close(htmlout);
    }
}









