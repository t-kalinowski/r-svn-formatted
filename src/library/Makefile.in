
#
# ${RHOME}/src/library/Makefile

VPATH = @srcdir@
srcdir = @srcdir@
top_srcdir = @top_srcdir@

top_builddir = ../..

include $(top_builddir)/Makeconf

MANSRC = `ls $(srcdir)/*/man/*.Rd`
PKGS = `ls $(srcdir) | sed '/^CVS/d; /Makefile/d; /^stamp-/d;'`

all: R

R:
	@$(MKINSTALLDIRS) $(top_builddir)/library
	@for pkg in $(PKGS); do \
	  cd $${pkg}; $(MAKE); cd ..; \
	done

docs: stamp-docs $(MANSRC) $(top_builddir)/library/LibIndex
help: stamp-help $(MANSRC) $(top_builddir)/library/LibIndex
html: stamp-html $(MANSRC)
latex: stamp-latex $(MANSRC)

stamp-docs:
	@echo "Building ALL documentation (help, HTML, LaTeX, R-Examples)"
	@$(MAKE) DOCS
	@touch $@
	@touch stamp-help
	@touch stamp-html
	@touch stamp-latex
	@touch stamp-example
stamp-help:
	@OPTS="--nroff" $(MAKE) DOCS
	@touch $@
stamp-html:
	@OPTS="--html"  $(MAKE) DOCS
	@touch $@
stamp-latex:
	@OPTS="--latex" $(MAKE) DOCS
	@touch $@
stamp-example:
	@OPTS="--example" $(MAKE) DOCS
	@touch $@

$(MANSRC):

$(top_builddir)/library/LibIndex:
	@if [ ! -f $@ ]; then touch $@; fi

DOCS:
	@for pkg in $(PKGS); do \
	  RHOME=`cd $(top_builddir); pwd`; export RHOME; \
	  $${RHOME}/bin/build-help $${OPTS} $(srcdir)/$${pkg}; \
	done

mostlyclean: clean
clean:
	@for pkg in $(PKGS); do \
	  cd $${pkg}; $(MAKE) $@; cd ..; \
	done
	@rm -f stamp-*
distclean:
	@for pkg in $(PKGS); do \
	  cd $${pkg}; $(MAKE) $@; cd ..; \
	done
	@rm -f Makefile
maintainer-clean: distclean

install install-strip uninstall TAGS info dvi check::
