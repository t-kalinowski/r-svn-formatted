#
# ${R_HOME}/src/library/grDevices/src/cairo/Makefile

VPATH = @srcdir@
srcdir = @srcdir@
top_srcdir = @top_srcdir@

top_builddir = ../../../../..
subdir = src/library/grDevices/src/cairo
R_HOME = $(top_builddir)

include $(top_builddir)/Makeconf


ALL_CPPFLAGS = $(R_XTRA_CPPFLAGS) @CAIRO_CPPFLAGS@ \
  -I$(top_srcdir)/src/modules/X11 $(CPPFLAGS) $(DEFS)
ALL_CFLAGS = $(ALL_CFLAGS_LO)

SOURCES = cairoBM.c
OBJECTS = $(SOURCES:.c=.o) $(top_builddir)/src/modules/X11/rbitmap.o

cairo_la = cairo$(SHLIB_EXT)
## AIX needs LIBM
cairo_la_LIBADD = @CAIRO_LIBS@ @BITMAP_LIBS@ $(LIBR) $(LIBM) @DYLIB_UNDEFINED_ALLOWED_FALSE@ $(LIBINTL)

all: Makefile R

Makefile: $(srcdir)/Makefile.in \
  $(top_builddir)/config.status \
  $(SOURCES)
	@cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@

R: Makefile
	@$(MAKE) $(cairo_la)
	cp $(cairo_la) $(R_HOME)/library/grDevices/libs$(R_ARCH)

$(cairo_la): $(OBJECTS)
	$(SHLIB_LINK) -o $@ $(OBJECTS) $(cairo_la_LIBADD)

cairoBM.o: $(top_srcdir)/src/modules/X11/cairoX11.c cairoBM.h

mostlyclean: clean
clean:
	@-rm -rf .libs _libs *.o $(cairo_la)
distclean: clean
	@-rm -f Makefile
maintainer-clean: distclean
