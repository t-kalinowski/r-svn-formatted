#! /bin/sh

# ${R_HOME}/bin/INSTALL for installing add-on packages
# Usage:
#	R INSTALL [options] [-l lib] pkg_1 ... pkg_n

# @configure_input@

VERSION="0.2-1"
USAGE_MSG="Usage:  R INSTALL [options] [-l lib] pkg_1 ... pkg_n"

CLEAN=false
DEBUG=false
ERROR=false
BUILD_TEXT=true
BUILD_HTML=true
BUILD_LATEX=true
BUILD_HELP=true
BUILD_HELP_OPTS=
BUILD_EXAMPLE=true
SHLIB_OPTS=

USE_ZIP=

INSTALL='@INSTALL@'

NO_PERL5=@NO_PERL5@
NO_PERL5_MSG="\
*** Formatting and installing R help pages needs Perl version 5, which
*** does not seem to be installed on your system or is not in your path.
*** Please install either Perl 5 on your system and re-configure R or
*** get pre-formatted help pages from the nearest CRAN server.
*** The CRAN master site can be found at
***    http://www.ci.tuwien.ac.at/R
***    ftp://ftp.ci.tuwien.ac.at/pub/R"

PKGS=
lib=${R_HOME}/library

MAKE=${MAKE-@MAKE@}

TMPDIR="/tmp/R.INSTALL.$$"

umask 022

while test -n "${1}"; do
  case ${1} in
    -h|--help|-\?)
      echo "${USAGE_MSG}"; exit 0 ;;
    -V|--version)
      echo "${VERSION}"; exit 0 ;;
    -c|--clean)
      CLEAN=true ;;
    --debug)
      DEBUG=true; SHLIB_OPTS="${SHLIB_OPTS} --debug" ;;
    --no-docs)
      BUILD_TEXT=false
      BUILD_HTML=false
      BUILD_LATEX=false
      BUILD_EXAMPLE=false ;;
    --no-text)
      BUILD_TEXT=false ;;
    --no-html)
      BUILD_HTML=false ;;
    --no-latex)
      BUILD_LATEX=false ;;
    --no-example)
      BUILD_EXAMPLE=false ;;
    --use-zip)
      USE_ZIP=true ;;
    -l|--library)
      lib=${2}; shift ;;
    *)
<<<<<<< INSTALL.in
      if test -d "${1}"; then
	PKGS="${PKGS} \"`cd "${1}"; pwd`\""
=======
      if test -f "${1}"; then
        mkdir -p ${TMPDIR}
	PKGNAME=`basename "${1}"`
	PKGNAME=`echo "${PKGNAME}" | sed 's/_.*//'`
	gzip -dc "${1}" | (cd ${TMPDIR} && tar -xf -)
	if test -d "${TMPDIR}/${PKGNAME}"; then
	  PKGS="${PKGS} \"`cd "${TMPDIR}/${PKGNAME}"; pwd`\""
	else
	  echo "ERROR: cannot extract package from ${1}"
	  exit 1
	fi    
      elif test -d "${1}"; then
	PKGS="${PKGS} \"`cd "${1}"; pwd`\""
}

eval "for pkg in ${PKGS}; do do_install \"\${pkg}\"; done"

if test -d "${TMPDIR}"; then
  cd /
  rm -rf "${TMPDIR}"
fi

echo "DONE (INSTALL)"

### Local Variables: ***
### mode: sh ***
### sh-indent: 2 ***
### End: ***
