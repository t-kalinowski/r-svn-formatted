
R : Copyright 2001, The R Development Core Team
Version 1.3.0 Under development (unstable) (2001-03-06)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> options(digits=7)
> 
> ## powers, including complex ones
> outer(a <- -4:12,     -2:7, "^")
             [,1]        [,2] [,3] [,4] [,5] [,6]  [,7]   [,8]    [,9]    [,10]
 [1,] 0.062500000 -0.25000000    1   -4   16  -64   256  -1024    4096   -16384
 [2,] 0.111111111 -0.33333333    1   -3    9  -27    81   -243     729    -2187
 [3,] 0.250000000 -0.50000000    1   -2    4   -8    16    -32      64     -128
 [4,] 1.000000000 -1.00000000    1   -1    1   -1     1     -1       1       -1
 [5,]         Inf         Inf    1    0    0    0     0      0       0        0
 [6,] 1.000000000  1.00000000    1    1    1    1     1      1       1        1
 [7,] 0.250000000  0.50000000    1    2    4    8    16     32      64      128
 [8,] 0.111111111  0.33333333    1    3    9   27    81    243     729     2187
 [9,] 0.062500000  0.25000000    1    4   16   64   256   1024    4096    16384
[10,] 0.040000000  0.20000000    1    5   25  125   625   3125   15625    78125
[11,] 0.027777778  0.16666667    1    6   36  216  1296   7776   46656   279936
[12,] 0.020408163  0.14285714    1    7   49  343  2401  16807  117649   823543
[13,] 0.015625000  0.12500000    1    8   64  512  4096  32768  262144  2097152
[14,] 0.012345679  0.11111111    1    9   81  729  6561  59049  531441  4782969
[15,] 0.010000000  0.10000000    1   10  100 1000 10000 100000 1000000 10000000
[16,] 0.008264463  0.09090909    1   11  121 1331 14641 161051 1771561 19487171
[17,] 0.006944444  0.08333333    1   12  144 1728 20736 248832 2985984 35831808
> m <- outer(-4:12 +0i, b <- seq(-.5,2, by=.5), "^")
> dimnames(m) <- list(paste(a), "^" = sapply(b,format))
> round(m,3)
    ^
             -0.5    0          0.5     1           1.5      2
  -4 0.000-0.500i 1+0i 0.000+2.000i -4+0i  0.000-8.000i  16+0i
  -3 0.000-0.577i 1+0i 0.000+1.732i -3+0i  0.000-5.196i   9+0i
  -2 0.000-0.707i 1+0i 0.000+1.414i -2+0i  0.000-2.828i   4+0i
  -1 0.000-1.000i 1+0i 0.000+1.000i -1+0i  0.000-1.000i   1+0i
  0    Inf+0.000i 1+0i 0.000+0.000i  0+0i  0.000+0.000i   0+0i
  1  1.000+0.000i 1+0i 1.000+0.000i  1+0i  1.000+0.000i   1+0i
  2  0.707+0.000i 1+0i 1.414+0.000i  2+0i  2.828+0.000i   4+0i
  3  0.577+0.000i 1+0i 1.732+0.000i  3+0i  5.196+0.000i   9+0i
  4  0.500+0.000i 1+0i 2.000+0.000i  4+0i  8.000+0.000i  16+0i
  5  0.447+0.000i 1+0i 2.236+0.000i  5+0i 11.180+0.000i  25+0i
  6  0.408+0.000i 1+0i 2.449+0.000i  6+0i 14.697+0.000i  36+0i
  7  0.378+0.000i 1+0i 2.646+0.000i  7+0i 18.520+0.000i  49+0i
  8  0.354+0.000i 1+0i 2.828+0.000i  8+0i 22.627+0.000i  64+0i
  9  0.333+0.000i 1+0i 3.000+0.000i  9+0i 27.000+0.000i  81+0i
  10 0.316+0.000i 1+0i 3.162+0.000i 10+0i 31.623+0.000i 100+0i
  11 0.302+0.000i 1+0i 3.317+0.000i 11+0i 36.483+0.000i 121+0i
  12 0.289+0.000i 1+0i 3.464+0.000i 12+0i 41.569+0.000i 144+0i
> 
> for (n1 in 1:7)
+     print(zapsmall(polyroot(1:n1), digits = 10))
complex(0)
[1] -0.5+0i
[1] -0.3333333+0.4714045i -0.3333333-0.4714045i
[1] -0.0720852+0.6383267i -0.6058296+0.0000000i -0.0720852-0.6383267i
[1]  0.1378323+0.6781544i -0.5378323+0.3582847i -0.5378323-0.3582847i
[4]  0.1378323-0.6781544i
[1]  0.2941946+0.6683671i -0.3756952+0.5701752i -0.3756952-0.5701752i
[4]  0.2941946-0.6683671i -0.6703320+0.0000000i
[1]  0.4106842+0.6398894i -0.6341119+0.2876550i -0.2051437-0.6837970i
[4]  0.4106842-0.6398894i -0.2051437+0.6837970i -0.6341119-0.2876550i
> 
> ## fft():
> for(n in 1:30) cat("\nn=",n,":", round(fft(1:n), 8),"\n")

n= 1 : 1+0i 

n= 2 : 3+0i -1+0i 

n= 3 : 6+0i -1.5+0.8660254i -1.5-0.8660254i 

n= 4 : 10+0i -2+2i -2+0i -2-2i 

n= 5 : 15+0i -2.5+3.440955i -2.5+0.8122992i -2.5-0.8122992i -2.5-3.440955i 

n= 6 : 21+0i -3+5.196152i -3+1.732051i -3+0i -3-1.732051i -3-5.196152i 

n= 7 : 28+0i -3.5+7.267825i -3.5+2.791157i -3.5+0.7988522i -3.5-0.7988522i -3.5-2.791157i -3.5-7.267825i 

n= 8 : 36+0i -4+9.656854i -4+4i -4+1.656854i -4+0i -4-1.656854i -4-4i -4-9.656854i 

n= 9 : 45+0i -4.5+12.36365i -4.5+5.362891i -4.5+2.598076i -4.5+0.7934714i -4.5-0.7934714i -4.5-2.598076i -4.5-5.362891i -4.5-12.36365i 

n= 10 : 55+0i -5+15.38842i -5+6.88191i -5+3.632713i -5+1.624598i -5+0i -5-1.624598i -5-3.632713i -5-6.88191i -5-15.38842i 

n= 11 : 66+0i -5.5+18.73128i -5.5+8.558167i -5.5+4.765777i -5.5+2.511766i -5.5+0.7907806i -5.5-0.7907806i -5.5-2.511766i -5.5-4.765777i -5.5-8.558167i -5.5-18.73128i 

n= 12 : 78+0i -6+22.39230i -6+10.39230i -6+6i -6+3.464102i -6+1.607695i -6+0i -6-1.607695i -6-3.464102i -6-6i -6-10.39230i -6-22.39230i 

n= 13 : 91+0i -6.5+26.37154i -6.5+12.38472i -6.5+7.336983i -6.5+4.486626i -6.5+2.465125i -6.5+0.7892429i -6.5-0.7892429i -6.5-2.465125i -6.5-4.486626i -6.5-7.336983i -6.5-12.38472i -6.5-26.37154i 

n= 14 : 105+0i -7+30.66900i -7+14.53565i -7+8.777722i -7+5.582314i -7+3.371022i -7+1.597704i -7+0i -7-1.597704i -7-3.371022i -7-5.582314i -7-8.777722i -7-14.53565i -7-30.66900i 

n= 15 : 120+0i -7.5+35.28473i -7.5+16.84528i -7.5+10.32286i -7.5+6.75303i -7.5+4.330127i -7.5+2.436898i -7.5+0.7882818i -7.5-0.7882818i -7.5-2.436898i -7.5-4.330127i -7.5-6.75303i -7.5-10.32286i -7.5-16.84528i -7.5-35.28473i 

n= 16 : 136+0i -8+40.21872i -8+19.31371i -8+11.97285i -8+8i -8+5.345429i -8+3.313709i -8+1.591299i -8+0i -8-1.591299i -8-3.313709i -8-5.345429i -8-8i -8-11.97285i -8-19.31371i -8-40.21872i 

n= 17 : 153+0i -8.5+45.47098i -8.5+21.94103i -8.5+13.72797i -8.5+9.324056i -8.5+6.418902i -8.5+4.232497i -8.5+2.418459i -8.5+0.787641i -8.5-0.787641i -8.5-2.418459i -8.5-4.232497i -8.5-6.418902i -8.5-9.324056i -8.5-13.72797i -8.5-21.94103i -8.5-45.47098i 

n= 18 : 171+0i -9+51.04154i -9+24.72730i -9+15.58846i -9+10.72578i -9+7.551897i -9+5.196152i -9+3.275732i -9+1.586943i -9+0i -9-1.586943i -9-3.275732i -9-5.196152i -9-7.551897i -9-10.72578i -9-15.58846i -9-24.72730i -9-51.04154i 

n= 19 : 190+0i -9.5+56.93038i -9.5+27.67255i -9.5+17.55446i -9.5+12.2056i -9.5+8.745366i -9.5+6.20666i -9.5+4.167086i -9.5+2.405727i -9.5+0.7871924i -9.5-0.7871924i -9.5-2.405727i -9.5-4.167086i -9.5-6.20666i -9.5-8.745366i -9.5-12.2056i -9.5-17.55446i -9.5-27.67255i -9.5-56.93038i 

n= 20 : 210+0i -10+63.13752i -10+30.77684i -10+19.62611i -10+13.76382i -10+10i -10+7.265425i -10+5.095254i -10+3.249197i -10+1.583844i -10+0i -10-1.583844i -10-3.249197i -10-5.095254i -10-7.265425i -10-10i -10-13.76382i -10-19.62611i -10-30.77684i -10-63.13752i 

n= 21 : 231+0i -10.5+69.66295i -10.5+34.04016i -10.5+21.80347i -10.5+15.40067i -10.5+11.31631i -10.5+8.37347i -10.5+6.062178i -10.5+4.120946i -10.5+2.396556i -10.5+0.7868662i -10.5-0.7868662i -10.5-2.396556i -10.5-4.120946i -10.5-6.062178i -10.5-8.37347i -10.5-11.31631i -10.5-15.40067i -10.5-21.80347i -10.5-34.04016i -10.5-69.66295i 

n= 22 : 253+0i -11+76.50668i -11+37.46256i -11+24.08664i -11+17.11633i -11+12.69468i -11+9.531554i -11+7.069271i -11+5.023532i -11+3.229891i -11+1.581561i -11+0i -11-1.581561i -11-3.229891i -11-5.023532i -11-7.069271i -11-9.531554i -11-12.69468i -11-17.11633i -11-24.08664i -11-37.46256i -11-76.50668i 

n= 23 : 276+0i -11.5+83.66871i -11.5+41.04404i -11.5+26.47566i -11.5+18.91094i -11.5+14.1354i -11.5+10.74025i -11.5+8.117586i -11.5+5.95882i -11.5+4.087101i -11.5+2.389727i -11.5+0.7866216i -11.5-0.7866216i -11.5-2.389727i -11.5-4.087101i -11.5-5.95882i -11.5-8.117586i -11.5-10.74025i -11.5-14.1354i -11.5-18.91094i -11.5-26.47566i -11.5-41.04404i -11.5-83.66871i 

n= 24 : 300+0i -12+91.14905i -12+44.78461i -12+28.97056i -12+20.78461i -12+15.63870i -12+12i -12+9.207924i -12+6.928203i -12+4.970563i -12+3.21539i -12+1.57983i -12+0i -12-1.57983i -12-3.21539i -12-4.970563i -12-6.928203i -12-9.207924i -12-12i -12-15.63870i -12-20.78461i -12-28.97056i -12-44.78461i -12-91.14905i 

n= 25 : 325+0i -12.5+98.94769i -12.5+48.68429i -12.5+31.57140i -12.5+22.73742i -12.5+17.20477i -12.5+13.31115i -12.5+10.3409i -12.5+7.932741i -12.5+5.882054i -12.5+4.061496i -12.5+2.384503i -12.5+0.7864333i -12.5-0.7864333i -12.5-2.384503i -12.5-4.061496i -12.5-5.882054i -12.5-7.932741i -12.5-10.3409i -12.5-13.31115i -12.5-17.20477i -12.5-22.73742i -12.5-31.57140i -12.5-48.68429i -12.5-98.94769i 

n= 26 : 351+0i -13+107.0646i -13+52.74307i -13+34.27818i -13+24.76943i -13+18.83375i -13+14.67397i -13+11.51700i -13+8.973252i -13+6.822926i -13+4.93025i -13+3.204212i -13+1.578486i -13+0i -13-1.578486i -13-3.204212i -13-4.93025i -13-6.822926i -13-8.973252i -13-11.51700i -13-14.67397i -13-18.83375i -13-24.76943i -13-34.27818i -13-52.74307i -13-107.0646i 

n= 27 : 378+0i -13.5+115.4999i -13.5+56.96098i -13.5+37.09095i -13.5+26.88071i -13.5+20.52575i -13.5+16.08867i -13.5+12.73659i -13.5+10.05038i -13.5+7.794229i -13.5+5.823332i -13.5+4.041635i -13.5+2.380414i -13.5+0.7862855i -13.5-0.7862855i -13.5-2.380414i -13.5-4.041635i -13.5-5.823332i -13.5-7.794229i -13.5-10.05038i -13.5-12.73659i -13.5-16.08867i -13.5-20.52575i -13.5-26.88071i -13.5-37.09095i -13.5-56.96098i -13.5-115.4999i 

n= 28 : 406+0i -14+124.2534i -14+61.33801i -14+40.0097i -14+29.0713i -14+22.28087i -14+17.55544i -14+14i -14+11.16463i -14+8.796783i -14+6.742045i -14+4.898812i -14+3.195409i -14+1.577421i -14+0i -14-1.577421i -14-3.195409i -14-4.898812i -14-6.742045i -14-8.796783i -14-11.16463i -14-14i -14-17.55544i -14-22.28087i -14-29.0713i -14-40.0097i -14-61.33801i -14-124.2534i 

n= 29 : 435+0i -14.5+133.3253i -14.5+65.87416i -14.5+43.03447i -14.5+31.34124i -14.5+24.09919i -14.5+19.07442i -14.5+15.30746i -14.5+12.31641i -14.5+9.831244i -14.5+7.687413i -14.5+5.777328i -14.5+4.025905i -14.5+2.377154i -14.5+0.7861672i -14.5-0.7861672i -14.5-2.377154i -14.5-4.025905i -14.5-5.777328i -14.5-7.687413i -14.5-9.831244i -14.5-12.31641i -14.5-15.30746i -14.5-19.07442i -14.5-24.09919i -14.5-31.34124i -14.5-43.03447i -14.5-65.87416i -14.5-133.3253i 

n= 30 : 465+0i -15+142.7155i -15+70.56945i -15+46.16525i -15+33.69055i -15+25.98076i -15+20.64573i -15+16.65919i -15+13.50606i -15+10.89814i -15+8.660254i -15+6.67843i -15+4.873795i -15+3.188348i -15+1.576564i -15+0i -15-1.576564i -15-3.188348i -15-4.873795i -15-6.67843i -15-8.660254i -15-10.89814i -15-13.50606i -15-16.65919i -15-20.64573i -15-25.98076i -15-33.69055i -15-46.16525i -15-70.56945i -15-142.7155i 
> 
> ## lowess() {incl. sort, etc}:
> options(digits = 5)
> 
> lowess(c(3,2,6,3,8,4))$y # this used to differ on Linux
[1] 2.4259 3.4293 3.9896 5.2832 5.3386 4.9822
> 
> y1 <- c(3,1:2,5:2,4,1:3,3)
> lowess(y1)$y
 [1] 2.0723 2.4362 2.7508 3.0038 3.2036 3.2435 2.8485 2.4832 2.4197 2.5231
[11] 2.6286 2.7813
> lowess(y1, f = .4)$y
 [1] 2.7030 1.9593 2.4351 3.4933 4.0000 3.0000 2.4651 1.8579 1.7357 2.0000
[11] 2.7103 3.1184
> 
> lowess(c(y1,100), f = .4)$y
 [1] 2.2135 2.2468 2.5459 3.7984 4.0000 3.0000 2.8427 2.4999 2.1512 2.0000
[11] 2.7129 3.1195 3.4172
> 
> ## this is the test sample from Cleveland's original lowess.doc:
> x <- c(1:5, rep(6,10),8,10,12,14,50)
> y <- c(18,2,15,6,10,4,16,11,7,3,14,17,20,12,9,13,1,8,5,19)
> lowess(x,y, f = .25, iter = 0, delta = 0)$y
 [1] 13.6588 11.1446  8.7012  9.7220 10.0000 11.3000 11.3000 11.3000 11.3000
[10] 11.3000 11.3000 11.3000 11.3000 11.3000 11.3000 13.0000  6.4399  5.5959
[19]  5.4557 18.9982
> lowess(x,y, f = .25, iter = 0, delta = 3)$y
 [1] 13.6588 12.3466 11.0343  9.7220 10.5110 11.3000 11.3000 11.3000 11.3000
[10] 11.3000 11.3000 11.3000 11.3000 11.3000 11.3000 13.0000  6.4399  5.5959
[19]  5.4557 18.9982
> lowess(x,y, f = .25, iter = 2, delta = 0)$y
 [1] 14.8112 12.1154  8.9838  9.6757 10.0000 11.3460 11.3460 11.3460 11.3460
[10] 11.3460 11.3460 11.3460 11.3460 11.3460 11.3460 13.0000  6.7345  5.7437
[19]  5.4147 18.9981
>        
> 
